<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.23">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Nodar Okroshiashvili">
<meta name="dcterms.date" content="2021-04-21">
<meta name="keywords" content="eigenvectors and eigenvalues in python, gauss and gauss-jordan elimination with python, matrix image and kernel, advances of linear algebra with python, linear algebra advances with python, numpy, scipy">

<title>Advance Linear Algebra with Python - Part I</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../assets/favicon.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-1fe81d0376b2c50856e68e651e390326.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-f59cc608e70ce16b384b3e6fc30ca698.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": true,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="Advance Linear Algebra with Python - Part I">
<meta property="og:description" content="Data Software Engineering blog">
<meta property="og:image" content="https://okrodata.dev/posts/mathematics/linear_algebra_5_files/figure-html/cell-4-output-2.png">
<meta property="og:image:height" content="822">
<meta property="og:image:width" content="1180">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../open_source.html"> 
<span class="menu-text">Open Source</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/nodar-okroshiashvili/" target="_blank"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/Okroshiashvili" target="_blank"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Advance Linear Algebra with Python - Part I</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">Mathematics</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Nodar Okroshiashvili </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">April 21, 2021</p>
      </div>
    </div>
    
      
    </div>
    

  <div>
    <div class="keywords">
      <div class="block-title">Keywords</div>
      <p>eigenvectors and eigenvalues in python, gauss and gauss-jordan elimination with python, matrix image and kernel, advances of linear algebra with python, linear algebra advances with python, numpy, scipy</p>
    </div>
  </div>
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#vector" id="toc-vector" class="nav-link" data-scroll-target="#vector">Vector</a>
  <ul class="collapse">
  <li><a href="#basis-vectors" id="toc-basis-vectors" class="nav-link" data-scroll-target="#basis-vectors">Basis Vectors</a></li>
  </ul></li>
  <li><a href="#matrix" id="toc-matrix" class="nav-link" data-scroll-target="#matrix">Matrix</a>
  <ul class="collapse">
  <li><a href="#gaussian-elimination-of-a-matrix" id="toc-gaussian-elimination-of-a-matrix" class="nav-link" data-scroll-target="#gaussian-elimination-of-a-matrix">Gaussian Elimination of a Matrix</a></li>
  <li><a href="#gauss-jordan-elimination-of-a-matrix" id="toc-gauss-jordan-elimination-of-a-matrix" class="nav-link" data-scroll-target="#gauss-jordan-elimination-of-a-matrix">Gauss-Jordan Elimination of a Matrix</a></li>
  <li><a href="#the-inverse-of-a-matrix-using-gauss-jordan-elimination" id="toc-the-inverse-of-a-matrix-using-gauss-jordan-elimination" class="nav-link" data-scroll-target="#the-inverse-of-a-matrix-using-gauss-jordan-elimination">The Inverse of a Matrix Using Gauss-Jordan Elimination</a></li>
  <li><a href="#image-of-a-matrix" id="toc-image-of-a-matrix" class="nav-link" data-scroll-target="#image-of-a-matrix">Image of a Matrix</a></li>
  <li><a href="#kernel-of-a-matrix" id="toc-kernel-of-a-matrix" class="nav-link" data-scroll-target="#kernel-of-a-matrix">Kernel of a Matrix</a></li>
  <li><a href="#rank-of-a-matrix" id="toc-rank-of-a-matrix" class="nav-link" data-scroll-target="#rank-of-a-matrix">Rank of a Matrix</a></li>
  <li><a href="#find-the-basis-of-a-matrix" id="toc-find-the-basis-of-a-matrix" class="nav-link" data-scroll-target="#find-the-basis-of-a-matrix">Find the Basis of a Matrix</a></li>
  <li><a href="#transformations" id="toc-transformations" class="nav-link" data-scroll-target="#transformations">Transformations</a></li>
  <li><a href="#eigenvalues" id="toc-eigenvalues" class="nav-link" data-scroll-target="#eigenvalues">Eigenvalues</a></li>
  <li><a href="#eigenvectors" id="toc-eigenvectors" class="nav-link" data-scroll-target="#eigenvectors">Eigenvectors</a></li>
  <li><a href="#spectrum-and-spectral-radius" id="toc-spectrum-and-spectral-radius" class="nav-link" data-scroll-target="#spectrum-and-spectral-radius">Spectrum and Spectral Radius</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#conclusion-for-part-i" id="toc-conclusion-for-part-i" class="nav-link" data-scroll-target="#conclusion-for-part-i">Conclusion for part I</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>This is the <strong>fifth</strong> post in the blog series about linear algebra, covering advanced vector and matrix operations.</p>
<ol type="1">
<li><a href="../../posts/mathematics/linear_algebra_1.html">Introduction to Linear Algebra with Python</a></li>
<li><a href="../../posts/mathematics/linear_algebra_2.html">Basic Linear Algebra with Python</a></li>
<li>Intermediate linear algebra
<ol type="1">
<li><a href="../../posts/mathematics/linear_algebra_3.html">Intermediate Linear Algebra with Python - Part I</a></li>
<li><a href="../../posts/mathematics/linear_algebra_4.html">Intermediate Linear Algebra with Python - Part II</a></li>
</ol></li>
<li><strong>Advanced linear algebra</strong>
<ol type="1">
<li><strong>Advance Linear Algebra with Python - Part I</strong></li>
<li>Advance Linear Algebra with Python - Part II</li>
</ol></li>
</ol>
<p>In this post I start with introducing advanced parts of the vector operations and then continue with advanced matrix operations.</p>
<section id="vector" class="level2">
<h2 class="anchored" data-anchor-id="vector">Vector</h2>
<section id="basis-vectors" class="level3">
<h3 class="anchored" data-anchor-id="basis-vectors">Basis Vectors</h3>
<p>In the <a href="https://dsfabric.org/articles/mathematics/basics-of-linear-algebra.html">basics</a>, we saw what is a unit vector. To refresh, the unit vector is the vector with length 1 and the formula is</p>
<p><span class="math display">\[
\hat{X} = \frac{X}{\|X\|}
\]</span></p>
<p>For farther explanation, unit vectors can be used to represent the axes of a <a href="https://en.wikipedia.org/wiki/Cartesian_coordinate_system">Cartesian coordinate system</a>. For example in a three-dimensional Cartesian coordinate system such vectors are:</p>
<p><span class="math display">\[
\hat{i} =
\begin{bmatrix}
1 \\
0 \\
0
\end{bmatrix}
\quad
\hat{j} =
\begin{bmatrix}
0 \\
1 \\
0
\end{bmatrix}
\quad
\hat{k} =
\begin{bmatrix}
0 \\
0 \\
1
\end{bmatrix}
\]</span></p>
<p>which represents, <span class="math inline">\(x\)</span>, <span class="math inline">\(y\)</span>, and <span class="math inline">\(z\)</span> axes, respectively. For two dimensional space we have</p>
<p><span class="math display">\[
\hat{i} =
\begin{bmatrix}
1 \\
0
\end{bmatrix}
\quad
\hat{j} =
\begin{bmatrix}
0 \\
1
\end{bmatrix}
\]</span></p>
<p>Let deal with two-dimensional space to catch the idea of basis easily and then generalize this idea for higher dimensions. Imagine, we have vector space or collection of vectors <span class="math inline">\(\vec{V}\)</span> over the Cartesian coordinate system. This space includes all two-dimensional vectors, or in other words, vectors with only two elements, <span class="math inline">\(x\)</span>, and <span class="math inline">\(y\)</span>.</p>
<blockquote class="blockquote">
<p>A <strong>basis</strong>, call it <span class="math inline">\(B\)</span>, of vector space <span class="math inline">\(V\)</span> over the Cartesian coordinate system is a linearly independent subset of <span class="math inline">\(V\)</span> that spans whole vector space <span class="math inline">\(V\)</span>. To be precise, basis <span class="math inline">\(B\)</span> to be the basis it must satisfy two conditions:</p>
</blockquote>
<ul>
<li><p>Linearly independence property - states that all vectors in <span class="math inline">\(B\)</span> are linearly independent</p></li>
<li><p>The spanning property - states that <span class="math inline">\(B\)</span> spans whole <span class="math inline">\(V\)</span></p></li>
</ul>
<p>We can combine these two conditions in one sentence. <span class="math inline">\(B\)</span> is the basis if its all elements are linearly independent and every element of <span class="math inline">\(V\)</span> is a linear combination of elements of <span class="math inline">\(B\)</span>.</p>
<p>From these conditions, we can conclude that unit vectors <span class="math inline">\(\hat{i}\)</span> and <span class="math inline">\(\hat{j}\)</span> are the basis of <span class="math inline">\(\mathbb{R^2}\)</span>. This kind of bases are also called <strong>standard basis</strong> or <strong>natural basis</strong>. The standard basis are denoted by <span class="math inline">\(e_{1}\)</span>, <span class="math inline">\(e_{2}\)</span>, <span class="math inline">\(e_{3}\)</span> and so on. I will be consistent and use the later notation for standard basis and <span class="math inline">\(\hat{i}\)</span>, <span class="math inline">\(\hat{j}\)</span> and <span class="math inline">\(\hat{k}\)</span> for unit vectors.</p>
<p>These standard basis vectors are the basis in the sense that any other vector in <span class="math inline">\(V\)</span> can be expressed uniquely as a linear combination of these unit vectors. For example, every vector <span class="math inline">\(v\)</span> in two-dimensional space can be written as</p>
<p><span class="math display">\[
x\ e_{1} + y\ e_{2}
\]</span></p>
<p>where <span class="math inline">\(e_{1}\)</span> and <span class="math inline">\(e_{2}\)</span> are unit vectors and <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> are scalar components or elements of the vector <span class="math inline">\(v\)</span>.</p>
<p>Now, to generalize the idea for higher dimensions we just have to apply the same logic as above, for <span class="math inline">\(\mathbb{R^3}\)</span> and more. In <span class="math inline">\(\mathbb{R^3}\)</span> we have standard basis vectors <span class="math inline">\(e_{1}\)</span>, <span class="math inline">\(e_{2}\)</span>, <span class="math inline">\(e_{3}\)</span>, and generally for <span class="math inline">\(\mathbb{R^n}\)</span> we have standard basis vector space</p>
<p><span class="math display">\[
E =
\begin{bmatrix}
e_{1} \\
e_{2} \\
\cdots \\
e_{n}
\end{bmatrix}
\]</span></p>
<p>To generalize the definition of the basis further, let consider the following:</p>
<p><strong>If elements <span class="math inline">\(\{v_{1}, v_{2},\cdots,v_{n}\}\)</span> of <span class="math inline">\(V\)</span> generate <span class="math inline">\(V\)</span> and in addition they are linearly independent, then <span class="math inline">\(\{v_{1}, v_{2},\cdots,v_{n}\}\)</span> is called a basis of <span class="math inline">\(V\)</span>. We shall say that the elements <span class="math inline">\(v_{1}, v_{2},\cdots,v_{n}\)</span> constitute or form a basis of V.</strong> Vector space <span class="math inline">\(V\)</span> can have several basis.</p>
<p>At this stage, the notion of basis seems very abstract even for me, and believe me it was totally unclear for me until I solved some examples by hand. I’ll show you how to compute basis after explaining row-echelon and reduced row-echelon forms and you’ll understand it. However, it’s not enough only to know how to row-reduce the given matrix. It’s necessary to know which basis you want. Either column space or row space basis or the basis for nullspace. These notions are explained below and after that, we can find the basis for each of them.</p>
</section>
</section>
<section id="matrix" class="level2">
<h2 class="anchored" data-anchor-id="matrix">Matrix</h2>
<section id="gaussian-elimination-of-a-matrix" class="level3">
<h3 class="anchored" data-anchor-id="gaussian-elimination-of-a-matrix">Gaussian Elimination of a Matrix</h3>
<p>In linear algebra, Gaussian Elimination is the method to solve the system of linear equations. This method is the sequence of operations performed on the coefficient matrix of the system. Except for solving the linear systems, the method can be used to find the rank of a matrix, the determinant as well as the inverse of a square invertible matrix.</p>
<p>And what is the sequence of operations?</p>
<p>Under this notion, elementary row operations are meant. We’ve covered it in the previous post but for the refresher, ERO’s are:</p>
<ul>
<li><p>Interchange rows</p></li>
<li><p>Multiply each element in a row by a non-zero number</p></li>
<li><p>Multiply a row by a non-zero number and add the result to another row</p></li>
</ul>
<p>Performing Gaussian elimination results in the matrix in <strong>Row Echelon Form</strong>. The matrix is said to be in row echelon form if it satisfies the following conditions:</p>
<ul>
<li><p>The first non-zero element in each row, called the leading entry, is a 1</p></li>
<li><p>Each leading entry is in a column, which is the right side of the leading entry in the previous row</p></li>
<li><p>Below the leading entry in a column, all other entries are zero</p></li>
</ul>
<p>To catch the idea of this process, let consider the example. Actually, we have no matrix (not necessarily true), we have the system of linear equations in the following form:</p>
<p><span class="math display">\[
\begin{cases}
x + 2y - z = 5\\
3x + y - 2z = 9\\
-x + 4y + 2z = 0
\end{cases}
\]</span></p>
<p>Based on these equations we can form the following matrix</p>
<p><span class="math display">\[
\begin{bmatrix}
1 &amp; 2 &amp; -1 \\
3 &amp; 1 &amp; -2 \\
-1 &amp; 4 &amp; 2
\end{bmatrix}
\]</span></p>
<p>This matrix is called <strong>coefficient matrix</strong> as it contains the coefficients of the linear equations. Having the coefficient matrix, we can rewrite our system in the following form:</p>
<p><span class="math display">\[
Ax = b
\]</span></p>
<p>Where <span class="math inline">\(A\)</span> is the coefficient matrix, <span class="math inline">\(x\)</span> is the vector of the unknowns, and <span class="math inline">\(b\)</span> is the vector of the right-hand side components</p>
<p>To solve this simultaneous system, the coefficients matrix is not enough. We need something more, on which we can perform ELO’s. This matrix is:</p>
<p><span class="math display">\[
\begin{bmatrix}
1 &amp; 2 &amp; -1 &amp; |&amp; 5 \\
3 &amp; 1 &amp; -2 &amp; |&amp; 9 \\
-1 &amp; 4 &amp; 2 &amp; |&amp; 0
\end{bmatrix} = [A | b]
\]</span></p>
<p>which is called <strong>augmented matrix</strong>, which in turn gives us the possibility to perform ELO’s, in other words, we do Gaussian elimination and the resulted matrix will be in row echelon form. Using back substitution on the resulted matrix gives the solution to our system of equations.</p>
<p>Let do it by hand. We have the initial system</p>
<p><span class="math display">\[
\begin{bmatrix}
1 &amp; 2 &amp; -1 &amp; |&amp; 5 \\
3 &amp; 1 &amp; -2 &amp; |&amp; 9 \\
-1 &amp; 4 &amp; 2 &amp; |&amp; 0
\end{bmatrix}
\equiv
\begin{cases}
x + 2y - z = 5 \\
3x + y - 2z = 9 \\
-x + 4y + 2z = 0
\end{cases}
\]</span></p>
<p>Then, using ERO’s</p>
<ol type="1">
<li><span class="math inline">\(R3 \rightarrow R3 + R1\)</span></li>
</ol>
<p><span class="math display">\[
\begin{bmatrix}
1 &amp; 2 &amp; -1 &amp; |&amp; 5 \\
3 &amp; 1 &amp; -2 &amp; |&amp; 9 \\
0 &amp; 6 &amp; 1 &amp; |&amp; 5
\end{bmatrix}
\equiv
\begin{cases}
x + 2y - z = 5 \\
3x + y - 2z = 9 \\
6y + z = 5
\end{cases}
\]</span></p>
<ol start="2" type="1">
<li><span class="math inline">\(R2 \rightarrow R2 - 3R1\)</span></li>
</ol>
<p><span class="math display">\[
\begin{bmatrix}
1 &amp; 2 &amp; -1 &amp; |&amp; 5 \\
0 &amp; -5 &amp; 1 &amp; |&amp; -6 \\
0 &amp; 6 &amp; 1 &amp; |&amp; 5
\end{bmatrix}
\equiv
\begin{cases}
x + 2y - z = 5 \\
-5y + z = -6 \\
6y + z = 5
\end{cases}
\]</span></p>
<ol start="3" type="1">
<li><span class="math inline">\(R2 \rightarrow R2 + R3\)</span></li>
</ol>
<p><span class="math display">\[
\begin{bmatrix}
1 &amp; 2 &amp; -1 &amp; |&amp; 5 \\
0 &amp; 1 &amp; 2 &amp; |&amp; -1 \\
0 &amp; 6 &amp; 1 &amp; |&amp; 5
\end{bmatrix}
\equiv
\begin{cases}
x + 2y - z = 5 \\
y + 2z = -1 \\
6y + z = 5
\end{cases}
\]</span></p>
<ol start="4" type="1">
<li><span class="math inline">\(R3 \rightarrow R3 - 6R2\)</span></li>
</ol>
<p><span class="math display">\[
\begin{bmatrix}
1 &amp; 2 &amp; -1 &amp; |&amp; 5 \\
0 &amp; 1 &amp; 2 &amp; |&amp; -1 \\
0 &amp; 0 &amp; -11 &amp; |&amp; 11
\end{bmatrix}
\equiv
\begin{cases}
x + 2y - z = 5 \\
y + 2z = -1 \\
-11z = 11
\end{cases}
\]</span></p>
<ol start="5" type="1">
<li><span class="math inline">\(R3 \rightarrow R3 \cdot -\frac{1}{11}\)</span></li>
</ol>
<p><span class="math display">\[
\begin{bmatrix}
1 &amp; 2 &amp; -1 &amp; |&amp; 5 \\
0 &amp; 1 &amp; 2 &amp; |&amp; -1 \\
0 &amp; 0 &amp; 1 &amp; |&amp; -1
\end{bmatrix}
\equiv
\begin{cases}
x + 2y - z = 5 \quad (A)\\
y + 2z = -1 \quad (B)\\
z = -1 \quad (C)
\end{cases}
\]</span></p>
<ol start="6" type="1">
<li>Back substitution</li>
</ol>
<p><span class="math display">\[
\begin{cases}
(C) \quad z = -1 \\
(B) \quad y = -1 - 2z \quad \Rightarrow \quad y = -1 - 2(-1) = 1 \\
(A) \quad x = 5 - 2y + z \quad \Rightarrow \quad x = 5 - 2(1) + (-1) = 2
\end{cases}
\]</span></p>
<ol start="7" type="1">
<li>Solution</li>
</ol>
<p><span class="math display">\[
x = 2 \\
y = 1 \\
x = -1
\]</span></p>
<p>This is the solution of the initial system, as well as the last system and every intermediate system. The matrix obtained in step 5 above is in Row-Echelon form as it satisfied above-mentioned conditions.</p>
<p><strong>Note that, starting with a particular matrix, a different sequence of ERO’s can lead to different row echelon form</strong></p>
</section>
<section id="gauss-jordan-elimination-of-a-matrix" class="level3">
<h3 class="anchored" data-anchor-id="gauss-jordan-elimination-of-a-matrix">Gauss-Jordan Elimination of a Matrix</h3>
<p>Gaussian elimination performs row operations to produce zeros below the main diagonal of the coefficient matrix to reduce it to row echelon form. Once it’s done we perform back substitution to find the solution. However, we can continue performing ERO’s to reduce coefficient matrix farther, to produce <strong>Reduced Row Echelon Form</strong>. The matrix is in reduced row echelon form if it satisfies the following conditions:</p>
<ul>
<li><p>It is in row echelon form</p></li>
<li><p>The leading entry in each row is the only non-zero entry in its column</p></li>
</ul>
<p>Gauss-Jordan elimination starts when Gauss elimination left off. Loosely speaking, Gaussian elimination works from the top down and when it stops, we start Gauss-Jordan elimination from the bottom up. The Reduced Row Echelon Form matrix is the result of Gauss-Jordan Elimination process.</p>
<p>We can continue our example from step 5 and see what is Gauss-Jordan elimination. At step 5 we had</p>
<ol type="1">
<li><span class="math inline">\(R3 \rightarrow R3 \cdot -\frac{1}{11}\)</span></li>
</ol>
<p><span class="math display">\[
\begin{bmatrix}
1 &amp; 2 &amp; -1 &amp; |&amp; 5 \\
0 &amp; 1 &amp; 2 &amp; |&amp; -1 \\
0 &amp; 0 &amp; 1 &amp; |&amp; -1
\end{bmatrix}
\equiv
\begin{cases}
x + 2y - z = 5 \\
y + 2z = -1 \\
z = -1
\end{cases}
\]</span></p>
<p>Now, from bottom to up we perform the following ERO’s</p>
<ol start="6" type="1">
<li><span class="math inline">\(R2 \rightarrow R2 - 2R3\)</span></li>
</ol>
<p><span class="math display">\[
\begin{bmatrix}
1 &amp; 2 &amp; -1 &amp; |&amp; 5 \\
0 &amp; 1 &amp; 0 &amp; |&amp; 1 \\
0 &amp; 0 &amp; 1 &amp; |&amp; -1
\end{bmatrix}
\equiv
\begin{cases}
x + 2y - z = 5 \\
y  = 1 \\
z = -1
\end{cases}
\]</span></p>
<ol start="7" type="1">
<li><span class="math inline">\(R1 \rightarrow R1 + R3\)</span></li>
</ol>
<p><span class="math display">\[
\begin{bmatrix}
1 &amp; 2 &amp; 0 &amp; |&amp; 4 \\
0 &amp; 1 &amp; 0 &amp; |&amp; 1 \\
0 &amp; 0 &amp; 1 &amp; |&amp; -1
\end{bmatrix}
\equiv
\begin{cases}
x + 2y = 4 \\
y  = 1 \\
z = -1
\end{cases}
\]</span></p>
<ol start="8" type="1">
<li><span class="math inline">\(R1 \rightarrow R1 - 2R2\)</span></li>
</ol>
<p><span class="math display">\[
\begin{bmatrix}
1 &amp; 0 &amp; 0 &amp; |&amp; 2 \\
0 &amp; 1 &amp; 0 &amp; |&amp; 1 \\
0 &amp; 0 &amp; 1 &amp; |&amp; -1
\end{bmatrix}
\equiv
\begin{cases}
x = 2 \\
y = 1 \\
z = -1
\end{cases}
\]</span></p>
<p>The solution is</p>
<p><span class="math display">\[
x = 2 \\
y = 1 \\
x = -1
\]</span></p>
<p>and this is the same as the solution of the Gauss elimination. The matrix in step 8 is the Reduced Row Echelon Form of our initial coefficient matrix <span class="math inline">\(A\)</span>.</p>
</section>
<section id="the-inverse-of-a-matrix-using-gauss-jordan-elimination" class="level3">
<h3 class="anchored" data-anchor-id="the-inverse-of-a-matrix-using-gauss-jordan-elimination">The Inverse of a Matrix Using Gauss-Jordan Elimination</h3>
<p>Suppose, we have given the matrix and want to find its inverse but do not want to use the technique mentioned in the intermediate post. We can use Gauss-Jordan elimination with little modification to find the inverse of a matrix. To be consistent, I use the above coefficient matrix but not the right-hand side of the system. So, our matrix is</p>
<p><span class="math display">\[
A =
\begin{bmatrix}
1 &amp; 2 &amp; -1 \\
3 &amp; 1 &amp; -2 \\
-1 &amp; 4 &amp; 2
\end{bmatrix}
\]</span></p>
<p>To find the inverse of <span class="math inline">\(A\)</span>, we need to augment <span class="math inline">\(A\)</span> by the identity matrix <span class="math inline">\(I\)</span> which has the same dimensions as <span class="math inline">\(A\)</span>. It is a must the identity to have the same dimensions. After augmentation we have</p>
<p><span class="math display">\[
[A | I] =
\begin{bmatrix}
1 &amp; 2 &amp; -1 &amp; |&amp; 1 &amp; 0 &amp; 0 \\
3 &amp; 1 &amp; -2 &amp; |&amp; 0 &amp; 1 &amp; 0 \\
-1 &amp; 4 &amp; 2 &amp; |&amp; 0 &amp; 0 &amp; 1
\end{bmatrix}
\]</span></p>
<p>We have to perform elementary row operations in the same way as we did in the above example. Particularly,</p>
<ol type="1">
<li><span class="math inline">\(R3 \rightarrow R3 + R1\)</span></li>
</ol>
<p><span class="math display">\[
\begin{bmatrix}
1 &amp; 2 &amp; -1 &amp; |&amp; 1 &amp; 0 &amp; 0\\
3 &amp; 1 &amp; -2 &amp; |&amp; 0 &amp; 1 &amp; 0\\
0 &amp; 6 &amp; 1 &amp; |&amp; 1 &amp; 0 &amp; 1
\end{bmatrix}
\]</span></p>
<ol start="2" type="1">
<li><span class="math inline">\(R2 \rightarrow R2 - 3R1\)</span></li>
</ol>
<p><span class="math display">\[
\begin{bmatrix}
1 &amp; 2 &amp; -1 &amp; |&amp; 1 &amp; 0 &amp; 0\\
0 &amp; -5 &amp; 1 &amp; |&amp; -3 &amp; 1 &amp; -3\\
0 &amp; 6 &amp; 1 &amp; |&amp; 1 &amp; 0 &amp; 1
\end{bmatrix}
\]</span></p>
<ol start="3" type="1">
<li><span class="math inline">\(R2 \rightarrow R2 + R3\)</span></li>
</ol>
<p><span class="math display">\[
\begin{bmatrix}
1 &amp; 2 &amp; -1 &amp; |&amp; 1 &amp; 0 &amp; 0\\
0 &amp; 1 &amp; 2 &amp; |&amp; -2 &amp; 1 &amp; -2\\
0 &amp; 6 &amp; 1 &amp; |&amp; 1 &amp; 0 &amp; 1
\end{bmatrix}
\]</span></p>
<ol start="4" type="1">
<li><span class="math inline">\(R3 \rightarrow R3 - 6R2\)</span></li>
</ol>
<p><span class="math display">\[
\begin{bmatrix}
1 &amp; 2 &amp; -1 &amp; |&amp; 1 &amp; 0 &amp; 0\\
0 &amp; 1 &amp; 2 &amp; |&amp; -2 &amp; 1 &amp; -2\\
0 &amp; 0 &amp; -11 &amp; |&amp; 13 &amp; -6 &amp; 13
\end{bmatrix}
\]</span></p>
<ol start="5" type="1">
<li><span class="math inline">\(R3 \rightarrow R3 \cdot -\frac{1}{11}\)</span></li>
</ol>
<p><span class="math display">\[
\begin{bmatrix}
1 &amp; 2 &amp; -1 &amp; |&amp; 1 &amp; 0 &amp; 0\\
0 &amp; 1 &amp; 2 &amp; |&amp; -2 &amp; 1 &amp; -2\\
0 &amp; 0 &amp; 1 &amp; |&amp; -\frac{13}{11} &amp; \frac{6}{11} &amp; -\frac{13}{11}
\end{bmatrix}
\]</span></p>
<ol start="6" type="1">
<li><span class="math inline">\(R2 \rightarrow R2 - 2R3\)</span></li>
</ol>
<p><span class="math display">\[
\begin{bmatrix}
1 &amp; 2 &amp; -1 &amp; |&amp; 1 &amp; 0 &amp; 0\\
0 &amp; 1 &amp; 0 &amp; |&amp; \frac{4}{11} &amp; -\frac{9}{100} &amp; \frac{4}{11}\\
0 &amp; 0 &amp; 1 &amp; |&amp; -\frac{13}{11} &amp; \frac{6}{11} &amp; -\frac{13}{11}
\end{bmatrix}
\]</span></p>
<ol start="7" type="1">
<li><span class="math inline">\(R1 \rightarrow R1 + R3\)</span></li>
</ol>
<p><span class="math display">\[
\begin{bmatrix}
1 &amp; 2 &amp; 0 &amp; |&amp; -\frac{2}{11} &amp; \frac{6}{11} &amp; -\frac{13}{11}\\
0 &amp; 1 &amp; 0 &amp; |&amp; \frac{4}{11} &amp; -\frac{9}{100} &amp; \frac{4}{11}\\
0 &amp; 0 &amp; 1 &amp; |&amp; -\frac{13}{11} &amp; \frac{6}{11} &amp; -\frac{13}{11}
\end{bmatrix}
\]</span></p>
<ol start="8" type="1">
<li><span class="math inline">\(R1 \rightarrow R1 - 2R2\)</span></li>
</ol>
<p><span class="math display">\[
\begin{bmatrix}
1 &amp; 0 &amp; 0 &amp; |&amp; -\frac{10}{11} &amp; \frac{18}{25} &amp; -\frac{21}{11}\\
0 &amp; 1 &amp; 0 &amp; |&amp; \frac{4}{11} &amp; -\frac{9}{100} &amp; \frac{4}{11}\\
0 &amp; 0 &amp; 1 &amp; |&amp; -\frac{13}{11} &amp; \frac{6}{11} &amp; -\frac{13}{11}
\end{bmatrix}
\]</span></p>
<p>Our inverse of <span class="math inline">\(A\)</span> is</p>
<p><span class="math display">\[
A^{-1} =
\begin{bmatrix}
-\frac{10}{11} &amp; \frac{18}{25} &amp; -\frac{21}{11}\\
\frac{4}{11} &amp; -\frac{9}{100} &amp; \frac{4}{11}\\
-\frac{13}{11} &amp; \frac{6}{11} &amp; -\frac{13}{11}
\end{bmatrix}
\]</span></p>
</section>
<section id="image-of-a-matrix" class="level3">
<h3 class="anchored" data-anchor-id="image-of-a-matrix">Image of a Matrix</h3>
<p>Let <span class="math inline">\(A\)</span> be <span class="math inline">\(m\times n\)</span> matrix. Space spanned by its column vectors are called range, image, or column space of a matrix <span class="math inline">\(A\)</span>. The row space is defined similarly. I only consider column space as all the logic is the same for row space.</p>
<p>The precise definition is the following:</p>
<p>Let <span class="math inline">\(A\)</span> be an <span class="math inline">\(m\times n\)</span> matrix, with column vectors <span class="math inline">\(v_{1}, v_{2}, \cdots, v_{n}\)</span>. A linear combination of these vectors is any vector of the following form: <span class="math inline">\(c_{1}v_{1} + c_{2}v_{2} + \cdots + c_{n}v_{n}\)</span>, where <span class="math inline">\(c_{1}, c_{2}, \cdots , c_{n}\)</span> are scalars. The set of all possible linear combinations of <span class="math inline">\(v_{1}, v_{2}, \cdots , v_{n}\)</span> is called the column space of <span class="math inline">\(A\)</span>.</p>
<p>For example:</p>
<p><span class="math display">\[
A =
\begin{bmatrix}
1 &amp; 0\\
0 &amp; 1\\
2 &amp; 0
\end{bmatrix}
\]</span></p>
<p>Column vectors are:</p>
<p><span class="math display">\[
v_{1} =
\begin{bmatrix}
1\\
0\\
2
\end{bmatrix}
\quad
v_{2} =
\begin{bmatrix}
0\\
1\\
0
\end{bmatrix}
\]</span></p>
<p>A linear combination of <span class="math inline">\(v_{1}\)</span> and <span class="math inline">\(v_{2}\)</span> is any vector of the form</p>
<p><span class="math display">\[
c_{1}
\begin{bmatrix}
1\\
0\\
2
\end{bmatrix} + c_{2}
\begin{bmatrix}
0\\
1\\
0
\end{bmatrix} =
\begin{bmatrix}
c_{1}\\
c_{2}\\
2c_{1}
\end{bmatrix}
\]</span></p>
<p>The set of all such vectors is the column space of <span class="math inline">\(A\)</span>.</p>
</section>
<section id="kernel-of-a-matrix" class="level3">
<h3 class="anchored" data-anchor-id="kernel-of-a-matrix">Kernel of a Matrix</h3>
<p>In linear algebra, the kernel or a.k.a null space is the solution of the following homogeneous system:</p>
<p><span class="math display">\[A\cdot X = 0\]</span></p>
<p>where <span class="math inline">\(A\)</span> is a <span class="math inline">\(m\times n\)</span> matrix and <span class="math inline">\(X\)</span> is a <span class="math inline">\(m\times 1\)</span> vector and is denoted by <span class="math inline">\(Ker(A)\)</span>.</p>
<p>For more clarity, let consider the numerical example. Lat our matrix <span class="math inline">\(A\)</span> be the following:</p>
<p><span class="math display">\[
A =
\begin{bmatrix}
2 &amp; 7 &amp; 1 &amp; 3 \\
-4 &amp; -2 &amp; 2 &amp; -2 \\
-1 &amp; 7 &amp; 3 &amp; 2 \\
-2 &amp; 2 &amp; 2 &amp; 0 \\
\end{bmatrix}
\]</span></p>
<p>and our <span class="math inline">\(X\)</span> is</p>
<p><span class="math display">\[
X =
\begin{bmatrix}
x_{1} \\
x_{2} \\
x_{3} \\
x_{4} \\
\end{bmatrix}
\]</span></p>
<p>We have to form the following system:</p>
<p><span class="math display">\[
A\cdot X =
\begin{bmatrix}
2 &amp; 7 &amp; 1 &amp; 3 \\
-4 &amp; -2 &amp; 2 &amp; -2 \\
-1 &amp; 7 &amp; 3 &amp; 2 \\
-2 &amp; 2 &amp; 2 &amp; 0 \\
\end{bmatrix}
\cdot
\begin{bmatrix}
x_{1} \\
x_{2} \\
x_{3} \\
x_{4} \\
\end{bmatrix} =
\begin{bmatrix}
0 \\
0 \\
0 \\
0 \\
\end{bmatrix}
\]</span></p>
<p>After that, we have to put this system into row-echelon or reduced row-echelon form. Let skip detailed calculation and present only results, which is the last matrix.</p>
<p><span class="math display">\[
A =
\begin{bmatrix}
2 &amp; 7 &amp; 1 &amp; 3\\
-4 &amp; -2 &amp; 2 &amp; -2\\
-1 &amp; 7 &amp; 3 &amp; 2\\
-2 &amp; 2 &amp; 2 &amp; 0
\end{bmatrix}
\rightarrow
\begin{bmatrix}
-1 &amp; 7 &amp; 3 &amp; 2\\
-4 &amp; -2 &amp; 2 &amp; -2\\
2 &amp; 7 &amp; 1 &amp; 3\\
-2 &amp; 2 &amp; 2 &amp; 0
\end{bmatrix}
\rightarrow
\begin{bmatrix}
-1 &amp; 7 &amp; 3 &amp; 2\\
0 &amp; -30 &amp; -10 &amp; -10\\
0 &amp; 21 &amp; 7 &amp; 7\\
0 &amp; -12 &amp; -4 &amp; -4
\end{bmatrix}
\]</span> <span class="math display">\[
\rightarrow
\begin{bmatrix}
-1 &amp; 7 &amp; 3 &amp; 2\\
0 &amp; 3 &amp; 1 &amp; 1\\
0 &amp; 3 &amp; 1 &amp; 1\\
0 &amp; 3 &amp; 1 &amp; 1
\end{bmatrix}
\rightarrow
\begin{bmatrix}
-1 &amp; 7 &amp; 3 &amp; 2\\
0 &amp; 3 &amp; 1 &amp; 1\\
0 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 0
\end{bmatrix}
\]</span></p>
<p>Now, to find the kernel of the original matrix <span class="math inline">\(A\)</span>, we have to solve the following system of equations:</p>
<p><span class="math display">\[
\begin{cases}
x_{1} - 7x_{2} - 3x_{3} - 2x_{4} = 0 \\
        3x_{2} + x_{3} + x_{4} = 0
\end{cases}
\rightarrow
\begin{cases}
x_{1} = \frac{2}{3}x_{3} - \frac{1}{3}x_{4}\\
x_{2} = -\frac{1}{3}x_{3} - \frac{1}{3}x_{4}
\end{cases}
\]</span></p>
<p>From this solution we conclude that the kernel of <span class="math inline">\(A\)</span> is</p>
<p><span class="math display">\[
Ker(A) =
\begin{bmatrix}
x_{1} = \frac{2}{3}x_{3} - \frac{1}{3}x_{4} \\
x_{2} = -\frac{1}{3}x_{3} - \frac{1}{3}x_{4} \\
x_{3} \\
x_{4}
\end{bmatrix}
\]</span></p>
<p>Where, <span class="math inline">\(x_{3}\)</span> and <span class="math inline">\(x_{4}\)</span> are free variables and can be any number in <span class="math inline">\(R\)</span></p>
<p>Note, that both original matrix <span class="math inline">\(A\)</span> and its row-echelon for has the same kernel. This means that row reduction preserves the kernel or null space.</p>
<div id="b0953d23" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.linalg <span class="im">import</span> null_space</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sympy <span class="im">import</span> Matrix</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="54d805fd" class="cell" data-execution_count="2">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">2</span>, <span class="dv">7</span>, <span class="dv">1</span>, <span class="dv">3</span>], [<span class="op">-</span><span class="dv">4</span>, <span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="op">-</span><span class="dv">2</span>], [<span class="op">-</span><span class="dv">1</span>, <span class="dv">7</span>, <span class="dv">3</span>, <span class="dv">2</span>], [<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">0</span>]])</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># This matrix is normalized, meaning that it has unit length</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>kernel_A <span class="op">=</span> null_space(A)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Normalized Kernel"</span>, kernel_A, sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># To find unnormalized kernel we have to do the following:</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> Matrix([[<span class="dv">2</span>, <span class="dv">7</span>, <span class="dv">1</span>, <span class="dv">3</span>], [<span class="op">-</span><span class="dv">4</span>, <span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="op">-</span><span class="dv">2</span>], [<span class="op">-</span><span class="dv">1</span>, <span class="dv">7</span>, <span class="dv">3</span>, <span class="dv">2</span>], [<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">0</span>]])</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>kernel_B <span class="op">=</span> B.nullspace()</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Unnormalized Kernel"</span>, kernel_B[<span class="dv">0</span>], sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co"># In unnormilized case, we clearly see that Sympy automatically choose values for our free variables.</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co"># In first case x_3 = 1; x_4 = 0 and in the second case x_3 = 0; x_4 = 1</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Resulted vector(s) are basis for the null space for our matrix A</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Normalized Kernel
[[-0.58983053  0.07100086]
 [ 0.14709576  0.39348879]
 [-0.73692629 -0.32248793]
 [ 0.29563901 -0.85797843]]
Unnormalized Kernel
Matrix([[2/3], [-1/3], [1], [0]])</code></pre>
</div>
</div>
</section>
<section id="rank-of-a-matrix" class="level3">
<h3 class="anchored" data-anchor-id="rank-of-a-matrix">Rank of a Matrix</h3>
<p>In the intermediate tutorial, you saw how to calculate the determinant of a matrix and also saw that any non zero determinant of sub-matrix of the original matrix shows its non-degenerateness. In other words, nonzero determinant gives us information about the rank of the matrix. Also, I said that there was not only one way to find the rank of a matrix. After reviewing Gauss and Gauss-Jordan Elimination and Row-Echelon and Reduced Row-Echelon forms you know that indeed there are other ways to find the determinant of a matrix as well as the rank of the matrix. To keep <a href="https://en.wikipedia.org/wiki/Don%27t_repeat_yourself">DRY</a>, here I only consider a numerical example. The code is provided in the intermediate tutorial.</p>
<p>Suppose we have matrix <span class="math inline">\(A\)</span> in the following form:</p>
<p><span class="math display">\[
A =
\begin{bmatrix}
3 &amp; 2 &amp; -1\\
2 &amp; -3 &amp; -5\\
-1 &amp; -4 &amp;- 3
\end{bmatrix}
\]</span></p>
<p>Perform Elementary Row Operations we get reduced-echelon form:</p>
<p><span class="math display">\[
A =
\begin{bmatrix}
3 &amp; 2 &amp; -1\\
2 &amp; -3 &amp; -5\\
-1 &amp; -4 &amp; -3
\end{bmatrix}
\rightarrow
\begin{bmatrix}
1 &amp; 4 &amp; 3\\
3 &amp; 2 &amp; -1\\
2 &amp; -3 &amp; -5
\end{bmatrix}
\rightarrow
\begin{bmatrix}
1 &amp; 4 &amp; 3\\
0 &amp; -10 &amp; -10\\
0 &amp; -11 &amp; -11
\end{bmatrix}
\]</span> <span class="math display">\[
\rightarrow
\begin{bmatrix}
1 &amp; 4 &amp; 3\\
0 &amp; 1 &amp; 1\\
0 &amp; -11 &amp; -11
\end{bmatrix}
\rightarrow
\begin{bmatrix}
1 &amp; 4 &amp; 3\\
0 &amp; 1 &amp; 1\\
0 &amp; 0 &amp; 0
\end{bmatrix}
\]</span></p>
<p>From the last matrix we see that the nonzero determinant only exists in <span class="math inline">\(2\times2\)</span> sub-matrices, hence rank of the matrix <span class="math inline">\(A\)</span> is 2.</p>
</section>
<section id="find-the-basis-of-a-matrix" class="level3">
<h3 class="anchored" data-anchor-id="find-the-basis-of-a-matrix">Find the Basis of a Matrix</h3>
<p>Now we are able to find the basis for column space and row space as well as the basis for the kernel. The columns of a matrix <span class="math inline">\(A\)</span> span the column space but they may not form a basis if the column vectors are linearly dependent. If this is the case, only some subset of these vectors forms the basis. To find the basis for column space we reduce matrix <span class="math inline">\(A\)</span> to reduced row-echelon form.</p>
<p>For example:</p>
<p><span class="math display">\[
A =
\begin{bmatrix}
2 &amp; 7 &amp; 1 &amp; 3 \\
-4 &amp; -2 &amp; 2 &amp; -2 \\
-1 &amp; 7 &amp; 3 &amp; 2 \\
-2 &amp; 2 &amp; 2 &amp; 0 \\
\end{bmatrix}
\]</span></p>
<p>Row reduced form of <span class="math inline">\(A\)</span> is:</p>
<p><span class="math display">\[
B =
\begin{bmatrix}
-1 &amp; 7 &amp; 3 &amp; 2\\
0 &amp; 3 &amp; 1 &amp; 1\\
0 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 0
\end{bmatrix}
\]</span></p>
<p>We see that only column 1 and column 2 are linearly independent in reduced form and hence column 1 and column 2 of the original matrix <span class="math inline">\(A\)</span> form the basis, which is:</p>
<p><span class="math display">\[
\begin{bmatrix}
2 \\-4\\-1\\-2
\end{bmatrix}
\quad
\text{and}
\quad
\begin{bmatrix}
7\\-2 \\ 7 \\ 2
\end{bmatrix}
\]</span></p>
<p>To find the basis for row space, let consider different matrix and again let it be <span class="math inline">\(A\)</span>.</p>
<p><span class="math display">\[
A =
\begin{bmatrix}
1 &amp; 3 &amp; 2 \\
2 &amp; 7 &amp; 4 \\
1 &amp; 5 &amp; 2
\end{bmatrix}
\]</span></p>
<p>To reduce <span class="math inline">\(A\)</span> to reduced row-echelon form we have:</p>
<p><span class="math display">\[
B =
\begin{bmatrix}
1 &amp; 0 &amp; 2 \\
0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 0
\end{bmatrix}
\]</span></p>
<p>As in column space case, we see that linearly independent, nonzero row vectors are</p>
<p><span class="math display">\[
\begin{bmatrix}
1 \\0\\2
\end{bmatrix}
\quad
\text{and}
\quad
\begin{bmatrix}
0\\1 \\ 0
\end{bmatrix}
\]</span></p>
<p>To find the basis for kernel let consider our old example. In this case our matrix is:</p>
<p><span class="math display">\[
A =
\begin{bmatrix}
2 &amp; 7 &amp; 1 &amp; 3 \\
-4 &amp; -2 &amp; 2 &amp; -2 \\
-1 &amp; 7 &amp; 3 &amp; 2 \\
-2 &amp; 2 &amp; 2 &amp; 0 \\
\end{bmatrix}
\]</span></p>
<p>And its row reduced form is</p>
<p><span class="math display">\[
B =
\begin{bmatrix}
-1 &amp; 7 &amp; 3 &amp; 2\\
0 &amp; 3 &amp; 1 &amp; 1\\
0 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 0
\end{bmatrix}
\]</span></p>
<p>We solved this and got the following result:</p>
<p><span class="math display">\[
Ker(A) =
\begin{bmatrix}
x_{1} = \frac{2}{3}x_{3} - \frac{1}{3}x_{4} \\
x_{2} = -\frac{1}{3}x_{3} - \frac{1}{3}x_{4} \\
x_{3} \\
x_{4}
\end{bmatrix}
\]</span></p>
<p>Now to have basis for null space just plug values for <span class="math inline">\(x_{3} = 1\)</span> and <span class="math inline">\(x_{4} = 0\)</span>, resulted vector is</p>
<p><span class="math display">\[
\begin{bmatrix}
\frac{2}{3} \\
-\frac{1}{3} \\
1 \\
0
\end{bmatrix}
\]</span></p>
<p>The resulted vector is one set of the basis for kernel space. The values for <span class="math inline">\(x_{3}\)</span> and <span class="math inline">\(x_{4}\)</span> are up to you as they are free variables.</p>
</section>
<section id="transformations" class="level3">
<h3 class="anchored" data-anchor-id="transformations">Transformations</h3>
<p>Matrices and vectors are used together to manipulate spatial dimensions. This has a lot of applications, including the mathematical generation of 3D computer graphics, geometric modeling, and the training and optimization of machine learning algorithms. Here, I present some types of transformation. However, the list will not be exhaustive. Firstly, define linear transformation:</p>
<blockquote class="blockquote">
<p>Linear transformation or linear map, is a mapping (function) between two vector spaces that preserves addition and scalar multiplication operations</p>
</blockquote>
<section id="linear-transformation" class="level4">
<h4 class="anchored" data-anchor-id="linear-transformation">Linear Transformation</h4>
<p>You can manipulate a vector by multiplying it with a matrix. The matrix acts like a function that operates on an input vector to produce a vector output. Specifically, matrix multiplications of vectors are <em>linear transformations</em> that transform the input vector into the output vector.</p>
<p>For example, consider a matrix <span class="math inline">\(A\)</span> and vector <span class="math inline">\(v\)</span></p>
<p><span class="math display">\[
A =
\begin{bmatrix}
2 &amp; 3 \\
5 &amp; 2
\end{bmatrix}
\quad
\vec{v} =
\begin{bmatrix}
1 \\
2
\end{bmatrix}
\]</span></p>
<p>Define transformation <span class="math inline">\(T\)</span> to be:</p>
<p><span class="math display">\[
T(\vec{v}) = A \vec{v}
\]</span></p>
<p>This transformation is simply dot or inner product and give the following result:</p>
<p><span class="math display">\[
T(\vec{v}) = A \vec{v} =
\begin{bmatrix}
8 \\
9
\end{bmatrix}
\]</span></p>
<p>In this case, both the input and output vector has 2 components. In other words, the transformation takes a 2-dimensional vector and produces a new 2-dimensional vector. Formally we can write this in the following way:</p>
<p><span class="math display">\[
T: \rm I\!R^{2} \to \rm I\!R^{2}
\]</span></p>
<p>The transformation does not necessarily have to be <span class="math inline">\(n \times n\)</span>. The dimension of the output vector and the input vector may differ. Rewrite our matrix <span class="math inline">\(A\)</span> and vector <span class="math inline">\(v\)</span>.</p>
<p><span class="math display">\[
A =
\begin{bmatrix}
2 &amp; 3 \\
5 &amp; 2 \\
1 &amp; 1
\end{bmatrix}
\quad
\vec{v} =
\begin{bmatrix}
1 \\
2
\end{bmatrix}
\]</span></p>
<p>Apply above transformation gives,</p>
<p><span class="math display">\[
T(\vec{v}) = A \vec{v} =
\begin{bmatrix}
8 \\
9 \\
3
\end{bmatrix}
\]</span></p>
<p>Now, our transformation transforms a vector from 2-dimensional space into 3-dimensional space. We can rite this transformation as</p>
<p><span class="math display">\[
T: \rm I\!R^{2} \to \rm I\!R^{3}
\]</span></p>
</section>
<section id="transformations-of-magnitude-and-amplitude" class="level4">
<h4 class="anchored" data-anchor-id="transformations-of-magnitude-and-amplitude">Transformations of Magnitude and Amplitude</h4>
<p>When we multiply a vector by a matrix we transform it in at least one of the following two ways</p>
<ul>
<li><p>Scale the length (Magnitude)</p></li>
<li><p>Change the direction (Amplitude)</p></li>
</ul>
<p><em>Change in length (Magnitude), but not change in direction (Amplitude)</em></p>
<p><span class="math display">\[
A =
\begin{bmatrix}
2 &amp; 0 \\
0 &amp; 2
\end{bmatrix}
\quad
\vec{v} =
\begin{bmatrix}
1 \\
0
\end{bmatrix}
\]</span></p>
<p>transformation gives,</p>
<p><span class="math display">\[
T(\vec{v}) = A \vec{v} =
\begin{bmatrix}
2 \\
0
\end{bmatrix}
\]</span></p>
<p>In this case, the resulted vector changed in length but not changed in direction.</p>
<div id="5b680dc1" class="cell" data-execution_count="3">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>v <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">0</span>])</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">2</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">2</span>]])</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> np.dot(A, v)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Resulted vector is: t = "</span>, t)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Original vector v is green and transformed vector t is blue.</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Vector t has same direction as v but greater magnitude</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>vecs <span class="op">=</span> np.array([t, v])</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>plt.axis(<span class="st">"equal"</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>plt.grid()</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>plt.quiver(<span class="dv">0</span>, <span class="dv">0</span>, <span class="op">*</span>t, color<span class="op">=</span>[<span class="st">"blue"</span>], scale<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>plt.quiver(<span class="dv">0</span>, <span class="dv">0</span>, <span class="op">*</span>v, color<span class="op">=</span>[<span class="st">"green"</span>], scale<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Resulted vector is: t =  [2 0]</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="linear_algebra_5_files/figure-html/cell-4-output-2.png" width="590" height="411" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p><em>Change in direction (Amplitude), but not change in length (Magnitude)</em></p>
<p><span class="math display">\[
A =
\begin{bmatrix}
0 &amp; -1 \\
1 &amp; 0
\end{bmatrix}
\quad
\vec{v} =
\begin{bmatrix}
1 \\
0
\end{bmatrix}
\]</span></p>
<p>transformation gives,</p>
<p><span class="math display">\[
T(\vec{v}) = A \vec{v} =
\begin{bmatrix}
0 \\
1
\end{bmatrix}
\]</span></p>
<p>This time, resulted vector changed in direction but has the same length.</p>
<div id="f5cd8810" class="cell" data-execution_count="4">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>v <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">0</span>])</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">0</span>, <span class="op">-</span><span class="dv">1</span>], [<span class="dv">1</span>, <span class="dv">0</span>]])</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> A <span class="op">@</span> v</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Resulted vector is: t = "</span>, t)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Resulted vector change the direction but has the same length</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>vecs <span class="op">=</span> np.array([v, t])</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>plt.axis(<span class="st">"equal"</span>)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>plt.grid()</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>plt.quiver(<span class="dv">0</span>, <span class="dv">0</span>, <span class="op">*</span>t, color<span class="op">=</span>[<span class="st">"blue"</span>], scale<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>plt.quiver(<span class="dv">0</span>, <span class="dv">0</span>, <span class="op">*</span>v, color<span class="op">=</span>[<span class="st">"green"</span>], scale<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Resulted vector is: t =  [0 1]</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="linear_algebra_5_files/figure-html/cell-5-output-2.png" width="590" height="411" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p><em>Change in direction (Amplitude) and in length (Magnitude)</em></p>
<p><span class="math display">\[
A =
\begin{bmatrix}
2 &amp; 1 \\
1 &amp; 2
\end{bmatrix}
\quad
\vec{v} =
\begin{bmatrix}
1 \\
0
\end{bmatrix}
\]</span></p>
<p>transformation gives,</p>
<p><span class="math display">\[
T(\vec{v}) = A \vec{v} =
\begin{bmatrix}
2 \\
1
\end{bmatrix}
\]</span></p>
<p>This time the resulted vector changed in the direction as well as the length.</p>
<div id="a6362e68" class="cell" data-execution_count="5">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>v <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">0</span>])</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">2</span>, <span class="dv">1</span>], [<span class="dv">1</span>, <span class="dv">2</span>]])</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> A <span class="op">@</span> v</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Resulted vector is: t = "</span>, t)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Resulted vector changed the direction, as well as the length</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>vecs <span class="op">=</span> np.array([v, t])</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>plt.axis(<span class="st">"equal"</span>)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>plt.grid()</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>plt.quiver(<span class="dv">0</span>, <span class="dv">0</span>, <span class="op">*</span>t, color<span class="op">=</span>[<span class="st">"blue"</span>], scale<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>plt.quiver(<span class="dv">0</span>, <span class="dv">0</span>, <span class="op">*</span>v, color<span class="op">=</span>[<span class="st">"green"</span>], scale<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Resulted vector is: t =  [2 1]</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="linear_algebra_5_files/figure-html/cell-6-output-2.png" width="590" height="411" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="affine-transformation" class="level4">
<h4 class="anchored" data-anchor-id="affine-transformation">Affine Transformation</h4>
<p>An Affine transformation multiplies a vector by a matrix and adds an offset vector, sometimes referred to as <em>bias</em>.</p>
<p><span class="math display">\[
T(\vec{v}) = A\vec{v} + \vec{b}
\]</span></p>
<p>Consider following example</p>
<p><span class="math display">\[
T(\vec{v}) = A\vec{v} + \vec{b} =
\begin{bmatrix}
5 &amp; 2\\
3 &amp; 1
\end{bmatrix} \cdot
\begin{bmatrix}
1\\
1
\end{bmatrix} +
\begin{bmatrix}
-2\\
-6
\end{bmatrix} =
\begin{bmatrix}
5\\
-2
\end{bmatrix}
\]</span></p>
<p>This kind of transformation is actually the basic block of linear regression, which is a core foundation for machine learning. However, these concepts are out of the scope of this tutorial. Python code is below for this transformation.</p>
<div id="eda7c4ea" class="cell" data-execution_count="6">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>v <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">1</span>])</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">5</span>, <span class="dv">2</span>], [<span class="dv">3</span>, <span class="dv">1</span>]])</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> np.array([<span class="op">-</span><span class="dv">2</span>, <span class="op">-</span><span class="dv">6</span>])</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> A <span class="op">@</span> v <span class="op">+</span> b</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Resulted vector is: t = "</span>, t)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co"># The resulted vector t is blue</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>vecs <span class="op">=</span> np.array([v, t])</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>plt.axis(<span class="st">"equal"</span>)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>plt.grid()</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>plt.quiver(<span class="dv">0</span>, <span class="dv">0</span>, <span class="op">*</span>t, color<span class="op">=</span>[<span class="st">"blue"</span>], scale<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>plt.quiver(<span class="dv">0</span>, <span class="dv">0</span>, <span class="op">*</span>v, color<span class="op">=</span>[<span class="st">"green"</span>], scale<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Resulted vector is: t =  [ 5 -2]</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="linear_algebra_5_files/figure-html/cell-7-output-2.png" width="590" height="411" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="eigenvalues" class="level3">
<h3 class="anchored" data-anchor-id="eigenvalues">Eigenvalues</h3>
<p>Let consider matrix <span class="math inline">\(A\)</span></p>
<p><span class="math display">\[
A =
\begin{bmatrix}
2 &amp; 0 &amp; 0 \\
0 &amp; 3 &amp; 4 \\
0 &amp; 4 &amp; 9
\end{bmatrix}
\]</span></p>
<p>Now, let multiply this matrix with vector <span class="math display">\[
\vec{v} =
\begin{bmatrix}
1 \\
0 \\
0
\end{bmatrix}
\]</span></p>
<p>We have the following:</p>
<p><span class="math display">\[
A \cdot v =
\begin{bmatrix}
2 &amp; 0 &amp; 0 \\
0 &amp; 3 &amp; 4 \\
0 &amp; 4 &amp; 9
\end{bmatrix}
\cdot
\begin{bmatrix}
1 \\
0 \\
0
\end{bmatrix} =
\begin{bmatrix}
2 \\
0 \\
0
\end{bmatrix} =
2 \cdot v
\]</span></p>
<p>That’s the beautiful relationship yes? To prove this is not the only one vector, which can do this try this vector <span class="math inline">\(\vec{v} = [0\quad 1\quad 2]\)</span> instead of old <span class="math inline">\(v\)</span>. You should get <span class="math inline">\(11\cdot \vec{v}\)</span></p>
<p>This beautiful relationship comes from the notion of eigenvalues and eigenvectors. In this case <span class="math inline">\(2\)</span> and <span class="math inline">\(11\)</span> are eigenvalues of the matrix <span class="math inline">\(A\)</span>.</p>
<p>Let formalize the notion of eigenvalue and eigenvector:</p>
<blockquote class="blockquote">
<p>Let <span class="math inline">\(A\)</span> be an <span class="math inline">\(n\times n\)</span> <strong>square</strong> matrix. If <span class="math inline">\(\lambda\)</span> is a scalar and <span class="math inline">\(v\)</span> is non-zero vector in <span class="math inline">\(\mathbb{R^n}\)</span> such that <span class="math inline">\(Av = \lambda v\)</span> then we say that <span class="math inline">\(\lambda\)</span> is an <em>eigenvalue</em> and <span class="math inline">\(v\)</span> is <em>eigenvector</em></p>
</blockquote>
<p>I believe you are interested in how to find eigenvalues. Consider again our matrix <span class="math inline">\(A\)</span> and follow steps to find eigenvalues. Given that our matrix <span class="math inline">\(A\)</span> is a square matrix, the condition that characterizes an eigenvalue <span class="math inline">\(\lambda\)</span> is the existence of a nonzero vector <span class="math inline">\(v\)</span> such that <span class="math inline">\(Av = \lambda v\)</span>. We can rewrite this equation in the following way:</p>
<p><span class="math display">\[
Av = \lambda v
\\
Av - \lambda v = 0
\\
Av - \lambda I v = 0
\\
(A - \lambda I)v = 0
\]</span></p>
<p>The final form of this equation makes it clear that <span class="math inline">\(v\)</span> is the solution of a square, homogeneous system. To have the nonzero solution(we required it in above definition), then the determinant of the <strong>coefficient matrix</strong> - <span class="math inline">\((A - \lambda I)\)</span> must be zero. This is achieved when the columns of the coefficient matrix are linearly dependent. In other words, to find eigenvalues we have to choose <span class="math inline">\(\lambda\)</span> such that to solve the following equation:</p>
<p><span class="math display">\[
det(A - \lambda I) = 0
\]</span></p>
<p>This equation is called <strong>characteristic equation</strong></p>
<p>For more clarity, let solve it with a particular example. We have square matrix <span class="math inline">\(A\)</span> and follow the above equation gives us:</p>
<p><span class="math display">\[
det(A - \lambda I) = det\Bigg(
\begin{bmatrix}
2 &amp; 0 &amp; 0 \\
0 &amp; 3 &amp; 4 \\
0 &amp; 4 &amp; 9
\end{bmatrix} -
\lambda \cdot
\begin{bmatrix}
1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 1
\end{bmatrix}
\Bigg) =
det\Bigg(
\begin{bmatrix}
2 - \lambda &amp; 0 &amp; 0 \\
0 &amp; 3 - \lambda &amp; 4 \\
0 &amp; 4 &amp; 9 - \lambda
\end{bmatrix}
\Bigg)
\Rightarrow
\]</span> <span class="math display">\[
\Rightarrow
(2 - \lambda)[(3 - \lambda)(9 - \lambda) - 16] =
-\lambda^3 + 14\lambda^2 - 35\lambda + 22
\]</span></p>
<p>The equation <span class="math inline">\(-\lambda^3 + 14\lambda^2 - 35\lambda + 22\)</span> is called <strong>characteristic polynomial</strong> of the matrix <span class="math inline">\(A\)</span> and will be of degree <span class="math inline">\(n\)</span> if <span class="math inline">\(A\)</span> is <span class="math inline">\(n\times n\)</span></p>
<p>The zeros or roots of this characteristic polynomial are the eigenvalues of the original matrix <span class="math inline">\(A\)</span>. In this case the roots are <span class="math inline">\(2\)</span>, <span class="math inline">\(1\)</span>, and <span class="math inline">\(11\)</span>. Surprise! Our matrix <span class="math inline">\(A\)</span> have three eigenvalues and two of them are already known for us from above example.</p>
<p>Eigenvalues of a square matrix <span class="math inline">\(A\)</span> have some nice features:</p>
<ul>
<li><p>The determinant of <span class="math inline">\(A\)</span> equals to the product of the eigenvalues</p></li>
<li><p>The trace of <span class="math inline">\(A\)</span> (The sum of the elements on the principal diagonal) equal the sum of the eigenvalues</p></li>
<li><p>If <span class="math inline">\(A\)</span> is symmetric matrix, then all of its eigenvalues are real</p></li>
<li><p>If <span class="math inline">\(A\)</span> is invertible (The determinant of <span class="math inline">\(A\)</span> is not zero) and <span class="math inline">\(\lambda_{1}, \cdots, \lambda_{n}\)</span> are its eigenvalues, then the eigenvalues of <span class="math inline">\(A^{-1}\)</span> are <span class="math inline">\(1 / \lambda_{1}, \cdots, 1 / \lambda_{n}\)</span></p></li>
</ul>
<p>From first feature we have that the matrix is invertible if and only if all its eigenvalues are nonzero.</p>
</section>
<section id="eigenvectors" class="level3">
<h3 class="anchored" data-anchor-id="eigenvectors">Eigenvectors</h3>
<p>It’s time to calculate eigenvectors, but let firstly define what is eigenvector and how it relates to the eigenvalue.</p>
<blockquote class="blockquote">
<p>Any nonzero vector <span class="math inline">\(v\)</span> which satisfies characteristic equation is said to be an eigenvector of <span class="math inline">\(A\)</span> corresponding to <span class="math inline">\(\lambda\)</span></p>
</blockquote>
<p>Continue above example and see what are eigenvectors corresponding to eigenvalues <span class="math inline">\(\lambda = 2\)</span>, <span class="math inline">\(\lambda = 1\)</span>, and <span class="math inline">\(\lambda = 11\)</span>, respectively.</p>
<p>Eigenvector for <span class="math inline">\(\lambda = 1\)</span></p>
<p><span class="math display">\[
(A - 1I)\cdot
\begin{bmatrix}
v_{1} \\
v_{2} \\
v_{3}
\end{bmatrix} =\Bigg(
\begin{bmatrix}
2 &amp; 0 &amp; 0 \\
0 &amp; 3 &amp; 4 \\
0 &amp; 4 &amp; 9
\end{bmatrix} -
\begin{bmatrix}
1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 1
\end{bmatrix}\Bigg)\cdot
\begin{bmatrix}
v_{1} \\
v_{2} \\
v_{3}
\end{bmatrix} =
\begin{bmatrix}
1 &amp; 0 &amp; 0 \\
0 &amp; 2 &amp; 4 \\
0 &amp; 4 &amp; 8
\end{bmatrix}\cdot
\begin{bmatrix}
v_{1} \\
v_{2} \\
v_{3}
\end{bmatrix}=
\begin{bmatrix}
0 \\
0 \\
0
\end{bmatrix}
\]</span></p>
<p>Rewrite this as a system of equations, we’ll get</p>
<p><span class="math display">\[
\begin{cases}
v_{1} = 0\\
2v_{2} + 4v_{3} = 0\\
4v_{2} + 8v{3} = 0
\end{cases}\rightarrow
\begin{cases}
v_{1} = 0 \\
v_{2} = -2v_{3}\\
v_{3} = 1
\end{cases}
\rightarrow
\begin{cases}
v_{1} = 0 \\
v_{2} = -2\\
v_{3} = 1
\end{cases}
\]</span></p>
<p>So, our eigenvector corresponding to eigenvalue <span class="math inline">\(\lambda = 1\)</span> is</p>
<p><span class="math display">\[
v_{\lambda = 1} =
\begin{bmatrix}
0 \\
-2 \\
1
\end{bmatrix}
\]</span></p>
<p>Finding eigenvectors for <span class="math inline">\(\lambda = 2\)</span> and <span class="math inline">\(\lambda = 11\)</span> is up to you.</p>
<div id="cb5eb61f" class="cell" data-execution_count="7">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">4</span>], [<span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">9</span>]])</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>eigenvalues, eigenvectors <span class="op">=</span> np.linalg.eig(A)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Note that this eigenvectors seems different from my calculation. However they are not different.</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># They are normalized to have unit length</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Eigenvalues are: "</span>, eigenvalues)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Eigenvectors are: "</span>, eigenvectors, sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Eigenvalues are:  [11.  1.  2.]
Eigenvectors are: 
[[ 0.          0.          1.        ]
 [ 0.4472136   0.89442719  0.        ]
 [ 0.89442719 -0.4472136   0.        ]]</code></pre>
</div>
</div>
</section>
<section id="spectrum-and-spectral-radius" class="level3">
<h3 class="anchored" data-anchor-id="spectrum-and-spectral-radius">Spectrum and Spectral Radius</h3>
<p>The <strong>Spectral Radius</strong> of a square matrix <span class="math inline">\(A\)</span> is the largest absolute values of its eigenvalues and is denoted by <span class="math inline">\(\rho(A)\)</span>. More formally,</p>
<blockquote class="blockquote">
<p>Spectral radius of a <span class="math inline">\(n \times n\)</span> matrix <span class="math inline">\(A\)</span> is:</p>
</blockquote>
<p><span class="math display">\[
\rho(A) = max
\Big\{
\mid \lambda
\mid \ :
\lambda \ is \ an \ eigenvalue \ of \ A
\Big\}
\]</span></p>
<p>Stated otherwise, we have</p>
<p><span class="math display">\[
\rho(A) = max
\Big\{
\mid \lambda_{1}
\mid,
\cdots,
\mid \lambda_{n}
\mid
\Big\}
\]</span></p>
<p>It’s noteworthy that the set of all eigenvalues</p>
<p><span class="math display">\[
\Big\{ \lambda : \lambda \in \lambda(A)
\Big\}
\]</span></p>
<p>is called the <strong>Spectrum</strong></p>
<p>From above example we had three eigenvalues, <span class="math inline">\(\lambda = 2\)</span>, <span class="math inline">\(\lambda = 1\)</span> and <span class="math inline">\(\lambda = 11\)</span> which are spectrum of <span class="math inline">\(A\)</span> and spectral radius for our matrix <span class="math inline">\(A\)</span> is <span class="math inline">\(\lambda = 11\)</span></p>
</section>
</section>
</section>
<section id="conclusion-for-part-i" class="level1">
<h1>Conclusion for part I</h1>
<p>In conclusion, part one turned out to be relatively heavy, as it contains lots of calculations. All these calculations are crucial for understanding the concepts and the theory behind them. I hope you enjoyed this post and learned something new.</p>
<p>The second part of this advanced concepts is devoted solely for matrix decompositions.</p>
<section id="references" class="level4">
<h4 class="anchored" data-anchor-id="references">References</h4>
<ul>
<li><a href="http://linear.axler.net/">Linear Algebra Done Right</a></li>
<li><a href="https://en.wikipedia.org/wiki/List_of_linear_algebra_topics">Linear Algebra Topics</a></li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/okrodata\.dev");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="light">
<script>
  function loadGiscus() {
    // Function to get the theme based on body class
    const getTheme = () => {
      let baseTheme = document.getElementById('giscus-base-theme').value;
      let altTheme = document.getElementById('giscus-alt-theme').value;
      return document.body.classList.contains('quarto-dark') ? altTheme : baseTheme;
    };
    const script = document.createElement("script");
    script.src = "https://giscus.app/client.js";
    script.async = true;
    script.dataset.repo = "Okroshiashvili/okrodata";
    script.dataset.repoId = "R_kgDOPtLDxQ";
    script.dataset.category = "General";
    script.dataset.categoryId = "";
    script.dataset.mapping = "title";
    script.dataset.reactionsEnabled = "1";
    script.dataset.emitMetadata = "0";
    script.dataset.inputPosition = "bottom";
    script.dataset.theme = getTheme();
    script.dataset.lang = "en";
    script.crossOrigin = "anonymous";
    // Append the script to the desired div instead of at the end of the body
    document.getElementById("quarto-content").appendChild(script);
  }
  loadGiscus();
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Copyright 2025, Nodar Okroshiashvili</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>