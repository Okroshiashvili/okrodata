<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.23">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Nodar Okroshiashvili">
<meta name="dcterms.date" content="2021-03-22">

<title>Intermediate Linear Algebra with Python - Part II</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../assets/favicon.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-1fe81d0376b2c50856e68e651e390326.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-f59cc608e70ce16b384b3e6fc30ca698.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": true,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="Intermediate Linear Algebra with Python - Part II">
<meta property="og:description" content="Part 4 of the linear algebra series with Python, that solely covers the matrices and matrix operations in more detail.">
<meta property="og:image" content="https://okrodata.dev/posts/mathematics/linear_algebra.jpg">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../open_source.html"> 
<span class="menu-text">Open Source</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/nodar-okroshiashvili/" target="_blank"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/Okroshiashvili" target="_blank"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Intermediate Linear Algebra with Python - Part II</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">Mathematics</div>
                <div class="quarto-category">Python</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Nodar Okroshiashvili </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">March 22, 2021</p>
      </div>
    </div>
    
      <div>
      <div class="quarto-title-meta-heading">Modified</div>
      <div class="quarto-title-meta-contents">
        <p class="date-modified">October 1, 2025</p>
      </div>
    </div>
      
    </div>
    
  <div>
    <div class="abstract">
      <div class="block-title">Abstract</div>
      <p>Part 4 of the linear algebra series with Python, that solely covers the matrices and matrix operations in more detail.</p>
    </div>
  </div>
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#matrix" id="toc-matrix" class="nav-link" data-scroll-target="#matrix">Matrix</a>
  <ul class="collapse">
  <li><a href="#types-of-matrices" id="toc-types-of-matrices" class="nav-link" data-scroll-target="#types-of-matrices">Types of Matrices</a></li>
  <li><a href="#trace-of-a-matrix" id="toc-trace-of-a-matrix" class="nav-link" data-scroll-target="#trace-of-a-matrix">Trace of a Matrix</a></li>
  <li><a href="#determinant-of-a-matrix" id="toc-determinant-of-a-matrix" class="nav-link" data-scroll-target="#determinant-of-a-matrix">Determinant of a Matrix</a></li>
  <li><a href="#minor-of-a-matrix" id="toc-minor-of-a-matrix" class="nav-link" data-scroll-target="#minor-of-a-matrix">Minor of a Matrix</a></li>
  <li><a href="#cofactor-of-a-matrix" id="toc-cofactor-of-a-matrix" class="nav-link" data-scroll-target="#cofactor-of-a-matrix">Cofactor of a Matrix</a></li>
  <li><a href="#determinant-of-a-matrix---continuation" id="toc-determinant-of-a-matrix---continuation" class="nav-link" data-scroll-target="#determinant-of-a-matrix---continuation">Determinant of a Matrix - continuation</a></li>
  <li><a href="#matrix-division" id="toc-matrix-division" class="nav-link" data-scroll-target="#matrix-division">Matrix Division</a></li>
  <li><a href="#inverse-of-a-matrix" id="toc-inverse-of-a-matrix" class="nav-link" data-scroll-target="#inverse-of-a-matrix">Inverse of a Matrix</a></li>
  <li><a href="#matrix-division---continuation" id="toc-matrix-division---continuation" class="nav-link" data-scroll-target="#matrix-division---continuation">Matrix Division - continuation</a></li>
  <li><a href="#solving-system-of-equations-with-matrices" id="toc-solving-system-of-equations-with-matrices" class="nav-link" data-scroll-target="#solving-system-of-equations-with-matrices">Solving System of Equations with Matrices</a></li>
  <li><a href="#elementary-row-operations" id="toc-elementary-row-operations" class="nav-link" data-scroll-target="#elementary-row-operations">Elementary Row Operations</a></li>
  <li><a href="#rank-of-a-matrix" id="toc-rank-of-a-matrix" class="nav-link" data-scroll-target="#rank-of-a-matrix">Rank of a Matrix</a></li>
  <li><a href="#power-of-a-matrix" id="toc-power-of-a-matrix" class="nav-link" data-scroll-target="#power-of-a-matrix">Power of a Matrix</a></li>
  <li><a href="#norm-of-a-matrix" id="toc-norm-of-a-matrix" class="nav-link" data-scroll-target="#norm-of-a-matrix">Norm of a Matrix</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="introduction" class="level1">
<h1>Introduction</h1>
<ol type="1">
<li><a href="../../posts/mathematics/linear_algebra_1.html">Introduction to Linear Algebra with Python</a></li>
<li><a href="../../posts/mathematics/linear_algebra_2.html">Basic Linear Algebra with Python</a></li>
<li><strong>Intermediate linear algebra</strong>
<ol type="1">
<li><a href="../../posts/mathematics/linear_algebra_3.html">Intermediate Linear Algebra with Python - Part I</a></li>
<li><strong>Intermediate Linear Algebra with Python - Part II</strong></li>
</ol></li>
<li>Advanced linear algebra
<ol type="1">
<li>Advance Linear Algebra with Python - Part I</li>
<li>Advance Linear Algebra with Python - Part II</li>
</ol></li>
</ol>
<p>In this post I will introduce you to the notion of matrix, different types of matrices, and how to operate on them. I will also show you how to use Python to manipulate matrices.</p>
<section id="matrix" class="level2">
<h2 class="anchored" data-anchor-id="matrix">Matrix</h2>
<section id="types-of-matrices" class="level3">
<h3 class="anchored" data-anchor-id="types-of-matrices">Types of Matrices</h3>
<p>During years of linear algebra evolution, there appeared different types of matrices. Some of them were fundamentals, some of them appeared lately. In this part, I will introduce some basic types of matrices and give you reference to find some other useful ones. Previously, I talked about the identity matrix, which operates as number 1 in matrix multiplication and is denoted by capital letter <span class="math inline">\(I\)</span>.</p>
<p>A <strong>square</strong> matrix is a matrix with the same number of rows and columns.</p>
<p><span class="math display">\[
A =
\begin{bmatrix}
    a_{11} &amp; a_{12} &amp; a_{13} \\
    a_{21} &amp; a_{22} &amp; a_{23} \\
    a_{31} &amp; a_{32} &amp; a_{33}
\end{bmatrix}
\]</span></p>
<p>A <strong>diagonal</strong> matrix is a matrix in which the entries on principal diagonal are non-zero and all the others are zeros.</p>
<p><span class="math display">\[
A =
\begin{bmatrix}
    1 &amp; 0 &amp; 0 \\
    0 &amp; 2 &amp; 0 \\
    0 &amp; 0 &amp; 3
\end{bmatrix}
\]</span></p>
<p>Scalar multiple of the identity matrix is called <strong>scalar</strong> matrix that is also diagonal. This means on the main diagonal all elements are equal.</p>
<p><span class="math display">\[
A =
\begin{bmatrix}
    2 &amp; 0 &amp; 0 \\
    0 &amp; 2 &amp; 0 \\
    0 &amp; 0 &amp; 2
\end{bmatrix}
\]</span></p>
<p>A square matrix is called <strong>triangular</strong> matrix if all of its elements above the main diagonal are zero (<strong>lower triangular matrix</strong>) or all of its elements below the main diagonal are zero (<strong>upper triangular matrix</strong>).</p>
<p><span class="math display">\[
A =
\begin{bmatrix}
    1 &amp; 0 &amp; 0 \\
    4 &amp; 5 &amp; 0 \\
    7 &amp; 8 &amp; 9
\end{bmatrix}
\quad
A =
\begin{bmatrix}
    1 &amp; 2 &amp; 3 \\
    0 &amp; 5 &amp; 6 \\
    0 &amp; 0 &amp; 9
\end{bmatrix}
\]</span></p>
<p>These matrices are lower and upper triangular matrices, respectively.</p>
<p>A <strong>null</strong> or <strong>zero</strong> matrix is a matrix with all elements equal to zero.</p>
<p><span class="math display">\[
A =
\begin{bmatrix}
    0 &amp; 0 &amp; 0 \\
    0 &amp; 0 &amp; 0 \\
    0 &amp; 0 &amp; 0
\end{bmatrix}
\]</span></p>
<p>A matrix of <strong>ones</strong> is where all elements equal to 1.</p>
<p><span class="math display">\[
A =
\begin{bmatrix}
    1 &amp; 1 &amp; 1 \\
    1 &amp; 1 &amp; 1 \\
    1 &amp; 1 &amp; 1
\end{bmatrix}
\]</span></p>
<p><strong>Symmetric</strong> matrix is a square matrix that is equal to its own transpose or <span class="math inline">\(A = A^T\)</span>. For example,</p>
<p><span class="math display">\[
A =
\begin{bmatrix}
    1 &amp; 2 &amp; 3 \\
    2 &amp; 4 &amp; 5 \\
    3 &amp; 5 &amp; 6
\end{bmatrix}
\]</span></p>
<p>is a symmetric matrix. Furthermore, matrix elements are symmetric with respect to main diagonal or are equal.</p>
<p>A <strong>skew-symmetric</strong> matrix is a square matrix whose transpose equals its negative or <span class="math inline">\(A^T = -A\)</span>. For example,</p>
<p><span class="math display">\[
A =
\begin{bmatrix}
    0 &amp; 3 &amp; 4 \\
    -3 &amp; 0 &amp; 7 \\
    -4 &amp; -7 &amp; 0
\end{bmatrix}
\quad
A^T =
\begin{bmatrix}
    0 &amp; -3 &amp; -4 \\
    3 &amp; 0 &amp; -7 \\
    4 &amp; 7 &amp; 0
\end{bmatrix}
\quad
-A =
\begin{bmatrix}
    0 &amp; -3 &amp; -4 \\
    3 &amp; 0 &amp; -7 \\
    4 &amp; 7 &amp; 0
\end{bmatrix}
\]</span></p>
<p><strong>Involutory</strong> matrix is a square matrix that is equal to its own inverse. More precisely, it is the matrix whose square is the identity matrix.</p>
<p><span class="math display">\[
A =
\begin{bmatrix}
    -5 &amp; -8 &amp; 0 \\
    3 &amp; 5 &amp; 0 \\
    1 &amp; 2 &amp; -1
\end{bmatrix}
\]</span></p>
<p>then</p>
<p><span class="math display">\[
A^2 =
\begin{bmatrix}
    -5 &amp; -8 &amp; 0 \\
    3 &amp; 5 &amp; 0 \\
    1 &amp; 2 &amp; -1
\end{bmatrix}
\cdot
\begin{bmatrix}
    -5 &amp; -8 &amp; 0 \\
    3 &amp; 5 &amp; 0 \\
    1 &amp; 2 &amp; -1
\end{bmatrix}
\ =
\begin{bmatrix}
    1 &amp; 0 &amp; 0 \\
    0 &amp; 1 &amp; 0 \\
    0 &amp; 0 &amp; 1
\end{bmatrix}
\ =
I
\]</span></p>
<p>A square matrix is called <strong>idempotent</strong> matrix, if multiplied by itself yields itself. Equivalently, <span class="math inline">\(A \cdot A = A\)</span></p>
<p><span class="math display">\[
A =
\begin{bmatrix}
    2 &amp; -2 &amp; -4 \\
    -1 &amp; 3 &amp; 4 \\
    1 &amp; -2 &amp; -3
\end{bmatrix}
\cdot
\begin{bmatrix}
    2 &amp; -2 &amp; -4 \\
    -1 &amp; 3 &amp; 4 \\
    1 &amp; -2 &amp; -3
\end{bmatrix}
\ =
\begin{bmatrix}
    2 &amp; -2 &amp; -4 \\
    -1 &amp; 3 &amp; 4 \\
    1 &amp; -2 &amp; -3
\end{bmatrix}
\]</span></p>
<p>A <strong>nildepotent</strong> matrix is such that <span class="math inline">\(A^k = 0\)</span> for some positive integer <span class="math inline">\(k\)</span>. This means, for some positive <span class="math inline">\(k\)</span>, multiplying matrix <span class="math inline">\(A\)</span> by <span class="math inline">\(k\)</span> times gives zero matrix. For matrix <span class="math inline">\(A\)</span> and for <span class="math inline">\(k=2\)</span> we have:</p>
<p><span class="math display">\[
A =
\begin{bmatrix}
    5 &amp; -3 &amp; 2 \\
    15 &amp; -9 &amp; 6 \\
    10 &amp; -6 &amp; 4
\end{bmatrix}
\]</span></p>
<p><span class="math display">\[
\quad
\]</span></p>
<p><span class="math display">\[
A^2 =
\begin{bmatrix}
    5 &amp; -3 &amp; 2 \\
    15 &amp; -9 &amp; 6 \\
    10 &amp; -6 &amp; 4
\end{bmatrix}
\cdot
\begin{bmatrix}
    5 &amp; -3 &amp; 2 \\
    15 &amp; -9 &amp; 6 \\
    10 &amp; -6 &amp; 4
\end{bmatrix}
\ =
\begin{bmatrix}
    0 &amp; 0 &amp; 0 \\
    0 &amp; 0 &amp; 0 \\
    0 &amp; 0 &amp; 0
\end{bmatrix}
\]</span></p>
<hr>
<p>So, as I said there are much much more matrices, but I restricted here due to limited space. If you think you need more, definitely check this out <a href="https://en.wikipedia.org/wiki/List_of_matrices">wikipedia page</a>.</p>
<div id="26f9ad12" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="56d049db" class="cell" data-execution_count="2">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Diagonal Matrix</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>diagonal <span class="op">=</span> np.diag([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>])</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Diagonal Matrix"</span>, diagonal, sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Lower Triangular Matrix</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>low_triang <span class="op">=</span> np.tril([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>], [<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>]])</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Lower Triangular Matrix"</span>, low_triang, sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Upper Triangular Matrix</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>upper_triang <span class="op">=</span> np.triu([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>], [<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>]])</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Upper Triangular Matrix"</span>, upper_triang, sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Matrix of Zeros</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>zeros <span class="op">=</span> np.zeros((<span class="dv">3</span>, <span class="dv">3</span>), dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Matrix of Zeros"</span>, zeros, sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Matrix of Ones</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>ones <span class="op">=</span> np.ones((<span class="dv">3</span>, <span class="dv">3</span>), dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Matrix of Ones"</span>, ones, sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Identity Matrix</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>identity <span class="op">=</span> np.eye(<span class="dv">3</span>, dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Identity Matrix"</span>, identity, sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Diagonal Matrix
[[1 0 0]
 [0 2 0]
 [0 0 3]]
Lower Triangular Matrix
[[1 0 0]
 [4 5 0]
 [7 8 9]]
Upper Triangular Matrix
[[1 2 3]
 [0 5 6]
 [0 0 9]]
Matrix of Zeros
[[0 0 0]
 [0 0 0]
 [0 0 0]]
Matrix of Ones
[[1 1 1]
 [1 1 1]
 [1 1 1]]
Identity Matrix
[[1 0 0]
 [0 1 0]
 [0 0 1]]</code></pre>
</div>
</div>
</section>
<section id="trace-of-a-matrix" class="level3">
<h3 class="anchored" data-anchor-id="trace-of-a-matrix">Trace of a Matrix</h3>
<p>The trace of <span class="math inline">\(n\times n\)</span> square matrix <span class="math inline">\(A\)</span> is the sum of all elements on the main diagonal. It is defined only for square matrices and the formula is:</p>
<p><span class="math display">\[
tr(A)=\sum_{i=1}^{n}a_{ii} = a_{11} + a_{22} + \cdots + a_{nn}
\]</span></p>
<p>Where <span class="math inline">\(a_{ii}\)</span> denotes the entry on <span class="math inline">\(i\)</span>-th row and <span class="math inline">\(j\)</span>-th column of matrix A.</p>
<p>For example, Let <span class="math inline">\(A\)</span> be a matrix,</p>
<p><span class="math display">\[
A =
\begin{bmatrix}
    a_{11} &amp; a_{12} &amp; a_{13} \\
    a_{21} &amp; a_{22} &amp; a_{23} \\
    a_{31} &amp; a_{32} &amp; a_{33}
\end{bmatrix}
\ =
\begin{bmatrix}
    1 &amp; 2 &amp; 3 \\
    4 &amp; 5 &amp; 6 \\
    7 &amp; 8 &amp; 9
\end{bmatrix}
\]</span></p>
<p>Then the trace is:</p>
<p><span class="math display">\[
tr(A)=\sum_{i=1}^{3}a_{ii} = a_{11} + a_{22} + a_{33} = 1 + 5 + 9 = 15
\]</span></p>
<div id="ff2a1ca7" class="cell" data-execution_count="3">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>], [<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>]])</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>trace <span class="op">=</span> np.trace(A)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Trace: "</span>, trace)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Trace:  15</code></pre>
</div>
</div>
</section>
<section id="determinant-of-a-matrix" class="level3">
<h3 class="anchored" data-anchor-id="determinant-of-a-matrix">Determinant of a Matrix</h3>
<p>There is no plain English definition of determinant but I’ll try to explain it by examples to catch the main idea behind of that special number. However, we can consider determinant as a function which as an input accepts <span class="math inline">\(n \times n\)</span> matrix and output real or a complex number, that is called determinant of input matrix and is denoted by <span class="math inline">\(det(A)\)</span> or <span class="math inline">\(|A|\)</span>.</p>
<p>For any <span class="math inline">\(2 \times 2\)</span> square matrix <span class="math inline">\(A\)</span> determinant is calculated by:</p>
<p><span class="math display">\[
A =
\begin{bmatrix}
    a &amp; b \\
    c &amp; d \\
\end{bmatrix}
\]</span></p>
<p><span class="math display">\[
det(A) = ad - bc
\]</span></p>
<p>It seems easy to calculate the determinant of any <span class="math inline">\(2 \times 2\)</span> matrix right? Now think about how to calculate determinant for higher dimensional matrices…did you find a way? If no, let me explain it step by step. If we have, say <span class="math inline">\(3 \times 3\)</span> matrix <span class="math inline">\(A\)</span> and want to calculate determinant we need some other notions such as <strong>minors</strong> and <strong>co-factors</strong> of that matrix.</p>
<div id="bd096845" class="cell" data-execution_count="4">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">2</span>], [<span class="dv">6</span>, <span class="dv">2</span>, <span class="dv">4</span>], [<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">8</span>]])</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>determinant <span class="op">=</span> np.linalg.det(A)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Determinant: "</span>, determinant)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Determinant:  -32.000000000000014</code></pre>
</div>
</div>
</section>
<section id="minor-of-a-matrix" class="level3">
<h3 class="anchored" data-anchor-id="minor-of-a-matrix">Minor of a Matrix</h3>
<p>A minor of matrix <span class="math inline">\(A\)</span> is the determinant of some smaller square matrix. Precisely, the minor <span class="math inline">\(M_{i,j}\)</span> is the <strong>determinant</strong> of matrix <span class="math inline">\(A\)</span> with row <span class="math inline">\(i\)</span> and column <span class="math inline">\(j\)</span> omitted. Minor of matrix <span class="math inline">\(A\)</span> is denoted by <span class="math inline">\(M_{ij}\)</span>, where <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> denotes element of <span class="math inline">\(i\)</span>-th row and <span class="math inline">\(j\)</span>-th column. Let have general matrix <span class="math inline">\(A\)</span>:</p>
<p><span class="math display">\[
A =
\begin{bmatrix}
    a_{11} &amp; a_{12} &amp; a_{13} \\
    a_{21} &amp; a_{22} &amp; a_{23} \\
    a_{31} &amp; a_{32} &amp; a_{33}
\end{bmatrix}
\]</span></p>
<p>We can take rows or columns to find all minors. It’s up to you which one you take, rows or columns. Let take the columns. We take the first element of our matrix <span class="math inline">\(a_{11}\)</span> and delete row and column along it. As the first element is <span class="math inline">\(a_{11}\)</span>, we have to delete first row and first column. After that, we take the second element of the first column which is <span class="math inline">\(a_{21}\)</span> and do same or delete second row and first column. After that, we take the third element of the first column <span class="math inline">\(a_{31}\)</span> and delete third row and first column. We have to do these for three columns. After all of that, we have:</p>
<p><span class="math display">\[
M_{11} =
\begin{bmatrix}
    \square &amp; \square &amp; \square \\
    \square &amp; a_{22} &amp; a_{23} \\
    \square &amp; a_{32} &amp; a_{33}
\end{bmatrix}
\ =
\begin{bmatrix}
    a_{22} &amp; a_{23} \\
    a_{32} &amp; a_{33}
\end{bmatrix}
\ =
a_{22}a_{33} - a_{23}a_{32}
\]</span> <span class="math display">\[
\quad
\]</span> <span class="math display">\[
M_{21} =
\begin{bmatrix}
    \square &amp; a_{12} &amp; a_{13} \\
    \square &amp; \square &amp; \square \\
    \square &amp; a_{32} &amp; a_{33}
\end{bmatrix}
\ =
\begin{bmatrix}
    a_{12} &amp; a_{13} \\
    a_{32} &amp; a_{33}
\end{bmatrix}
\ =
a_{12}a_{33} - a_{13}a_{32}
\]</span> <span class="math display">\[
\quad
\]</span> <span class="math display">\[
M_{31} =
\begin{bmatrix}
    \square &amp; a_{12} &amp; a_{13} \\
    \square &amp; a_{22} &amp; a_{23} \\
    \square &amp; \square &amp; \square
\end{bmatrix}
\ =
\begin{bmatrix}
    a_{12} &amp; a_{13} \\
    a_{22} &amp; a_{23}
\end{bmatrix}
\ =
a_{12}a_{23} - a_{13}a_{22}
\]</span> <span class="math display">\[
\quad
\]</span> <span class="math display">\[
M_{12} =
\begin{bmatrix}
    \square &amp; \square &amp; \square \\
    a_{21} &amp; \square &amp; a_{23} \\
    a_{31} &amp; \square &amp; a_{33}
\end{bmatrix}
\ =
\begin{bmatrix}
    a_{21} &amp; a_{23} \\
    a_{31} &amp; a_{33}
\end{bmatrix}
\ =
a_{21}a_{33} - a_{23}a_{31}
\]</span> <span class="math display">\[
\quad
\]</span> <span class="math display">\[
M_{22} =
\begin{bmatrix}
    a_{11} &amp; \square &amp; a_{13} \\
    \square &amp; \square &amp; \square \\
    a_{31} &amp; \square &amp; a_{33}
\end{bmatrix}
\ =
\begin{bmatrix}
    a_{11} &amp; a_{13} \\
    a_{31} &amp; a_{33}
\end{bmatrix}
\ =
a_{11}a_{33} - a_{13}a_{31}
\]</span> <span class="math display">\[
\quad
\]</span> <span class="math display">\[
M_{32} =
\begin{bmatrix}
    a_{11} &amp; \square &amp; a_{13} \\
    a_{21} &amp; \square &amp; a_{23} \\
    \square &amp; \square &amp; \square
\end{bmatrix}
\ =
\begin{bmatrix}
    a_{11} &amp; a_{13} \\
    a_{21} &amp; a_{13}
\end{bmatrix}
\ =
a_{11}a_{13} - a_{13}a_{21}
\]</span> <span class="math display">\[
\quad
\]</span> <span class="math display">\[
M_{13} =
\begin{bmatrix}
    \square &amp; \square &amp; \square \\
    a_{21} &amp; a_{22} &amp; \square \\
    a_{31} &amp; a_{32} &amp; \square
\end{bmatrix}
\ =
\begin{bmatrix}
    a_{21} &amp; a_{22} \\
    a_{31} &amp; a_{32}
\end{bmatrix}
\ =
a_{21}a_{32} - a_{22}a_{31}
\]</span> <span class="math display">\[
\quad
\]</span> <span class="math display">\[
M_{23} =
\begin{bmatrix}
    a_{11} &amp; a_{12} &amp; \square \\
    \square &amp; \square &amp; \square \\
    a_{31} &amp; a_{32} &amp; \square
\end{bmatrix}
\ =
\begin{bmatrix}
    a_{11} &amp; a_{12} \\
    a_{31} &amp; a_{32}
\end{bmatrix}
\ =
a_{11}a_{32} - a_{12}a_{31}
\]</span> <span class="math display">\[
\quad
\]</span> <span class="math display">\[
M_{33} =
\begin{bmatrix}
    a_{11} &amp; a_{12} &amp; \square \\
    a_{21} &amp; a_{22} &amp; \square \\
    \square &amp; \square &amp; \square
\end{bmatrix}
\ =
\begin{bmatrix}
    a_{11} &amp; a_{12} \\
    a_{21} &amp; a_{22}
\end{bmatrix}
\ =
a_{11}a_{22} - a_{12}a_{21}
\]</span></p>
<p>These nine scalars are minors of matrix <span class="math inline">\(A\)</span>. Once again, minor is not smaller matrix, it is <strong>determinant</strong> of a smaller matrix.</p>
</section>
<section id="cofactor-of-a-matrix" class="level3">
<h3 class="anchored" data-anchor-id="cofactor-of-a-matrix">Cofactor of a Matrix</h3>
<p>We left one more step to compute determinant of <span class="math inline">\(3 \times 3\)</span> matrix <span class="math inline">\(A\)</span>. This step is cofactor of matrix <span class="math inline">\(A\)</span>. The cofactor of matrix <span class="math inline">\(A\)</span> is the minor, multiplied by <span class="math inline">\((-1)^{i+j}\)</span> and is denoted by <span class="math inline">\(C_{ij}\)</span></p>
<p><span class="math display">\[
C_{ij} =
(-1)^{i+j} \cdot M_{ij}
\]</span></p>
<p>where <span class="math inline">\(i\)</span> is the number of row and <span class="math inline">\(j\)</span> is the number of column of matrix <span class="math inline">\(A\)</span>.</p>
<p>In the above case our co-factors are:</p>
<p><span class="math display">\[
C_{11} =
(-1)^{1+1} \cdot M_{11}
\]</span></p>
<p><span class="math display">\[
C_{21} =
(-1)^{2+1} \cdot M_{21}
\]</span></p>
<p><span class="math display">\[
C_{31} =
(-1)^{3+1} \cdot M_{31}
\]</span></p>
<p><span class="math display">\[
C_{12} =
(-1)^{1+2} \cdot M_{12}
\]</span></p>
<p><span class="math display">\[
C_{22} =
(-1)^{2+2} \cdot M_{22}
\]</span></p>
<p><span class="math display">\[
C_{32} =
(-1)^{3+2} \cdot M_{32}
\]</span></p>
<p><span class="math display">\[
C_{13} =
(-1)^{1+3} \cdot M_{13}
\]</span></p>
<p><span class="math display">\[
C_{23} =
(-1)^{2+3} \cdot M_{23}
\]</span></p>
<p><span class="math display">\[
C_{33} =
(-1)^{3+3} \cdot M_{33}
\]</span></p>
<p>So, the sum of <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> in the power of <span class="math inline">\((-1)\)</span> switch the sign of every minor.</p>
</section>
<section id="determinant-of-a-matrix---continuation" class="level3">
<h3 class="anchored" data-anchor-id="determinant-of-a-matrix---continuation">Determinant of a Matrix - continuation</h3>
<p>We are ready to compute the determinant of our <span class="math inline">\(3 \times 3\)</span> matrix <span class="math inline">\(A\)</span>. We need to expand this matrix along one of the row or one of the column to compute the determinant. It’s up to you which one you take, row or column. Let take the first column. Now, what does expansion means? We have to fix either <span class="math inline">\(i\)</span> if we choose a row, or <span class="math inline">\(j\)</span> if we choose column. At first glance it seems confusing but an example will make sense. This expansion is called <strong>Laplace Expansion</strong> and is used to compute the determinant of any <span class="math inline">\(n \times n\)</span> matrix.</p>
<p><span class="math display">\[
det(A) = \sum_{j\prime=1}^{n}a_{ij\prime}C_{ij\prime}
\ =
\sum_{i\prime=1}^{n}a_{i\prime j}C_{i\prime j}
\]</span></p>
<p>where <span class="math inline">\(i\prime\)</span> means we fixed index <span class="math inline">\(i\)</span> or row and we change only column index. In case of <span class="math inline">\(j\prime\)</span> we fixed index <span class="math inline">\(j\)</span> or columns and change the only row. So, when <span class="math inline">\(i\)</span> is fixed it is called row expansion and when <span class="math inline">\(j\)</span> is fixed it’s called column expansion. <span class="math inline">\(C_{ij}\)</span> is our co-factor.</p>
<p>To continue the above example, let expand our initial matrix <span class="math inline">\(A\)</span> by the first column, meaning I fix <span class="math inline">\(j\)</span> to be 1 and only change row index <span class="math inline">\(i\)</span> from 1 to 3. In this particular case above formula is:</p>
<p><span class="math display">\[
det(A) = \sum_{j\prime=1}^{3}a_{ij\prime}C_{ij\prime}
\ =
a_{11}C_{11} + a_{21}C_{21} + a_{31}C_{31}
\]</span></p>
<p>Instead, if I choose first row, I have to fix row index <span class="math inline">\(i\)</span> and change column index <span class="math inline">\(j\)</span> from 1 to 3 and determinant formula is:</p>
<p><span class="math display">\[
det(A) = \sum_{i\prime=1}^{3}a_{i\prime j}C_{i\prime j}
\ =
a_{11}C_{11} + a_{12}C_{12} + a_{13}C_{13}
\]</span></p>
<p>Below, you will see numerical example.</p>
</section>
<section id="matrix-division" class="level3">
<h3 class="anchored" data-anchor-id="matrix-division">Matrix Division</h3>
<p>We can’t actually divide matrix by a matrix; but when we want to divide matrices, we can take advantage of the fact that division by a given number is the same as multiplication by the reciprocal of that number.</p>
<p>For matrix division, we use a related idea; we multiply matrix by the <em>inverse</em> of a matrix. If we have two matrices <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>, we can do:</p>
<p><span class="math display">\[
A \div B = A \cdot B^{-1}
\]</span></p>
<p>Here, <span class="math inline">\(B^{-1}\)</span> is the inverse of matrix <span class="math inline">\(B\)</span>. As taking inverse of a matrix requires computations and is not easy, let explain it below and then return here.</p>
</section>
<section id="inverse-of-a-matrix" class="level3">
<h3 class="anchored" data-anchor-id="inverse-of-a-matrix">Inverse of a Matrix</h3>
<p>The matrix is said to be invertible if:</p>
<p><span class="math display">\[
A \cdot A^{-1} = I
\]</span></p>
<p>where <span class="math inline">\(I\)</span> is the identity matrix and <span class="math inline">\(A^{-1}\)</span> is the inverse of <span class="math inline">\(A\)</span>. Generally, matrix inverse is only defined for square matrices, but there still exist ways to take the inverse of non-square matrices but this is out of the scope of this blog series and I will not consider.</p>
<p>For <span class="math inline">\(2 \times 2\)</span> matrix <span class="math inline">\(A\)</span></p>
<p><span class="math display">\[
A =
\begin{bmatrix}
    a &amp; b \\
    c &amp; d \\
\end{bmatrix}
\]</span></p>
<p>Inverse of <span class="math inline">\(A\)</span> is:</p>
<p><span class="math display">\[
A^{-1} =
\frac{1}{ad-bc}
\begin{bmatrix}
    d &amp; -b \\
    -c &amp; a \\
\end{bmatrix}
\]</span></p>
<p>What happened there?</p>
<ul>
<li>I swapped the positions of a and d</li>
<li>I changed the signs of b and c</li>
<li>I multiplied the resulting matrix by 1 over the <strong>determinant</strong> of the matrix <span class="math inline">\(A\)</span></li>
</ul>
<p>For example,</p>
<p><span class="math display">\[
A =
\begin{bmatrix}
    6 &amp; 2 \\
    1 &amp; 2 \\
\end{bmatrix}
\quad
A^{-1} =
\frac{1}{(6 \times 2) - (2 \times 1)}
\begin{bmatrix}
    2 &amp; -2 \\
    -1 &amp; 6 \\
\end{bmatrix}
\ =
\begin{bmatrix}
    0.2 &amp; -0.2 \\
    -0.1 &amp; 0.6 \\
\end{bmatrix}
\]</span></p>
<p>to check if this is really the inverse of <span class="math inline">\(A\)</span>, multiply <span class="math inline">\(A\)</span> by its inverse in order to get an identity matrix.</p>
<p>Now let take the inverse of <span class="math inline">\(3 \times 3\)</span> matrix. This process is long and involves taking minors, co-factors and determinant. After that, above-mentioned operations should be understandable. It has to be mentioned that there are several ways to take matrix inverse but as I started here explaining minors, co-factors and determinant I use this technique to find inverse.</p>
<p>We can calculate the inverse by:</p>
<ul>
<li>step 1: <strong>Calculate the matrix of minors</strong></li>
<li>step 2: <strong>Turn the matrix of minors into the matrix of cofactors</strong></li>
<li>step 3: <strong>Transpose the matrix of cofactors</strong></li>
<li>step 4: <strong>Multiply transpose of cofactor by 1/determinant</strong></li>
</ul>
<p>Let have matrix:</p>
<p><span class="math display">\[
A =
\begin{bmatrix}
    4 &amp; 2 &amp; 2 \\
    6 &amp; 2 &amp; 4 \\
    2 &amp; 2 &amp; 8
\end{bmatrix}
\]</span></p>
<p>Step 1: <strong>Calculate the matrix of minors</strong></p>
<p><span class="math display">\[
M_{11} =
\begin{bmatrix}\color{blue}4 &amp; \color{lightgray}2 &amp; \color{lightgray}2\\\color{lightgray}6 &amp; \color{red}2 &amp; \color{red}4\\\color{lightgray}2 &amp; \color{red}2 &amp; \color{red}8\end{bmatrix}\;\;\;\;(2\times8) - (4\times2) = 8\;\;\;\;\begin{bmatrix}8 &amp; \color{lightgray}? &amp; \color{lightgray}?\\\color{lightgray}? &amp; \color{lightgray}? &amp; \color{lightgray}?\\\color{lightgray}? &amp; \color{lightgray}? &amp; \color{lightgray}?
\end{bmatrix}
\]</span></p>
<p><span class="math display">\[
M_{12} =
\begin{bmatrix}\color{lightgray}4 &amp; \color{blue}2 &amp; \color{lightgray}2\\\color{red}6 &amp; \color{lightgray}2 &amp; \color{red}4\\\color{red}2 &amp; \color{lightgray}2 &amp; \color{red}8\end{bmatrix}\;\;\;\;(6\times8) - (4\times2) = 40\;\;\;\;\begin{bmatrix}8 &amp; 40 &amp; \color{lightgray}?\\\color{lightgray}? &amp; \color{lightgray}? &amp; \color{lightgray}?\\\color{lightgray}? &amp; \color{lightgray}? &amp; \color{lightgray}?\end{bmatrix}
\]</span></p>
<p><span class="math display">\[
M_{13} =
\begin{bmatrix}\color{lightgray}4 &amp; \color{lightgray}2 &amp; \color{blue}2\\\color{red}6 &amp; \color{red}2 &amp; \color{lightgray}4\\\color{red}2 &amp; \color{red}2 &amp; \color{lightgray}8\end{bmatrix}\;\;\;\;(6\times2) - (2\times2) = 8\;\;\;\;\begin{bmatrix}8 &amp; 40 &amp; 8\\\color{lightgray}? &amp; \color{lightgray}? &amp; \color{lightgray}?\\\color{lightgray}? &amp; \color{lightgray}? &amp; \color{lightgray}?\end{bmatrix}
\]</span></p>
<p><span class="math display">\[
M_{21} =
\begin{bmatrix}\color{lightgray}4 &amp; \color{red}2 &amp; \color{red}2\\\color{blue}6 &amp; \color{lightgray}2 &amp; \color{lightgray}4\\\color{lightgray}2 &amp; \color{red}2 &amp; \color{red}8\end{bmatrix}\;\;\;\;(2\times8) - (2\times2) = 12\;\;\;\;\begin{bmatrix}8 &amp; 40 &amp; 8\\12 &amp; \color{lightgray}? &amp; \color{lightgray}?\\\color{lightgray}? &amp; \color{lightgray}? &amp; \color{lightgray}?\end{bmatrix}
\]</span></p>
<p><span class="math display">\[
M_{22} =
\begin{bmatrix}\color{red}4 &amp; \color{lightgray}2 &amp; \color{red}2\\\color{lightgray}6 &amp; \color{blue}2 &amp; \color{lightgray}4\\\color{red}2 &amp; \color{lightgray}2 &amp; \color{red}8\end{bmatrix}\;\;\;\;(4\times8) - (2\times2) = 28\;\;\;\;\begin{bmatrix}8 &amp; 40 &amp; 8\\12 &amp; 28 &amp; \color{lightgray}?\\\color{lightgray}? &amp; \color{lightgray}? &amp; \color{lightgray}?\end{bmatrix}
\]</span></p>
<p><span class="math display">\[
M_{23} =
\begin{bmatrix}\color{red}4 &amp; \color{red}2 &amp; \color{lightgray}2\\\color{lightgray}6 &amp; \color{lightgray}2 &amp; \color{blue}4\\\color{red}2 &amp; \color{red}2 &amp; \color{lightgray}8\end{bmatrix}\;\;\;\;(4\times2) - (2\times2) = 4\;\;\;\;\begin{bmatrix}8 &amp; 40 &amp; 8\\12 &amp; 28 &amp; 4\\\color{lightgray}? &amp; \color{lightgray}? &amp; \color{lightgray}?\end{bmatrix}
\]</span></p>
<p><span class="math display">\[
M_{31} =
\begin{bmatrix}\color{lightgray}4 &amp; \color{red}2 &amp; \color{red}2\\\color{lightgray}6 &amp; \color{red}2 &amp; \color{red}4\\\color{blue}2 &amp; \color{lightgray}2 &amp; \color{lightgray}8\end{bmatrix}\;\;\;\;(2\times4) - (2\times2) = 4\;\;\;\;\begin{bmatrix}8 &amp; 40 &amp; 8\\12 &amp; 28 &amp; 4\\4 &amp; \color{lightgray}? &amp; \color{lightgray}?\end{bmatrix}
\]</span></p>
<p><span class="math display">\[
M_{32} =
\begin{bmatrix}\color{red}4 &amp; \color{lightgray}2 &amp; \color{red}2\\\color{red}6 &amp; \color{lightgray}2 &amp; \color{red}4\\\color{lightgray}2 &amp; \color{blue}2 &amp; \color{lightgray}8\end{bmatrix}\;\;\;\;(4\times4) - (2\times6) = 4\;\;\;\;\begin{bmatrix}8 &amp; 40 &amp; 8\\12 &amp; 28 &amp; 4\\4 &amp; 4 &amp; \color{lightgray}?\end{bmatrix}
\]</span></p>
<p><span class="math display">\[
M_{33} =
\begin{bmatrix}\color{red}4 &amp; \color{red}2 &amp; \color{lightgray}2\\\color{red}6 &amp; \color{red}2 &amp; \color{lightgray}4\\\color{lightgray}2 &amp; \color{lightgray}2 &amp; \color{blue}8\end{bmatrix}\;\;\;\;(4\times2) - (2\times6) = -4\;\;\;\;\begin{bmatrix}8 &amp; 40 &amp; 8\\12 &amp; 28 &amp; 4\\4 &amp; 4 &amp; -4\end{bmatrix}
\]</span></p>
<p>Our matrix of minors is:</p>
<p><span class="math display">\[
M =
\begin{bmatrix}
    8 &amp; 40 &amp; 8 \\
    12 &amp; 28 &amp; 4 \\
    4 &amp; 4 &amp; -4
\end{bmatrix}
\]</span></p>
<p>Note that I used rows to find minors, in contrast to columns in the previous example.</p>
<p>Step 2: <strong>Turn the matrix of minors into the matrix of cofactors</strong></p>
<p>To turn minors matrix into cofactor matrix, we just need to change the sign of elements in minors matrix according to the rule proposed above section.</p>
<p>Cofactor matrix is:</p>
<p><span class="math display">\[
C =
\begin{bmatrix}
    8 &amp; -40 &amp; 8 \\
    -12 &amp; 28 &amp; -4 \\
    4 &amp; -4 &amp; -4
\end{bmatrix}
\]</span></p>
<p>Step 3: <strong>Transpose the matrix of cofactors</strong></p>
<p>We need to take the transpose of the cofactor matrix. In other words, swap their positions over the main diagonal (the main diagonal stays the same).</p>
<p><span class="math display">\[
C^{T}=
\begin{bmatrix}8 &amp; \color{green}-\color{green}1\color{green}2 &amp; \color{orange}4\\\color{green}-\color{green}4\color{green}0 &amp; 28 &amp; \color{purple}-\color{purple}4\\\color{orange}8 &amp; \color{purple}-\color{purple}4 &amp; -4\end{bmatrix}
\]</span></p>
<p>This matrix is called <strong>Adjugate</strong> or <strong>Adjoint</strong>, which is simple the transpose of the cofactor matrix.</p>
<p>Step 4: <strong>Multiply transpose of cofactor by <span class="math inline">\(\frac{1}{determinant}\)</span></strong></p>
<p>As we did all the necessary operations to have determinant, let compute it firstly and then multiply the adjoint matrix by <span class="math inline">\(\frac{1}{determinant}\)</span>.</p>
<p>Using formula:</p>
<p><span class="math display">\[
det(A) = \sum_{i\prime=1}^{3}a_{i\prime j}C_{i\prime j}
\ =
a_{11}C_{11} + a_{12}C_{12} + a_{13}C_{13}
\]</span></p>
<p>We have:</p>
<p><span class="math display">\[
det(A) = (4 \times 8) + (2 \times (-40)) + (2 \times 8) = -32
\]</span></p>
<p>Now the inverse is:</p>
<p><span class="math display">\[
A^{-1} =
\frac{1}{-32}
\cdot
\begin{bmatrix}
    8 &amp; -40 &amp; 8 \\
    -12 &amp; 28 &amp; -4 \\
    4 &amp; -4 &amp; -4
\end{bmatrix}
\ =
\begin{bmatrix}
    -0.25 &amp; 0.375 &amp; -0.125 \\
    1.25 &amp; 0.875 &amp; 0.125 \\
    -0.25 &amp; 0.125 &amp; 0.125
\end{bmatrix}
\]</span></p>
<p>Let’s verify that the original matrix multiplied by the inverse results in an identity matrix:</p>
<p><span class="math display">\[
A \cdot A^{-1} =
\begin{bmatrix}4 &amp; 2 &amp; 2\\6 &amp; 2 &amp; 4\\2 &amp; 2 &amp; 8\end{bmatrix} \cdot \begin{bmatrix}-0.25 &amp; 0.375 &amp; -0.125\\1.25 &amp; -0.875 &amp; 0.125\\-0.25 &amp; 0.125 &amp; 0.125\end{bmatrix} =
\begin{bmatrix}1 &amp; 0 &amp; 0\\0 &amp; 1 &amp; 0\\0 &amp; 0 &amp; 1\end{bmatrix} = I
\]</span></p>
<p>Do you see how challenging can be finding the inverse of <span class="math inline">\(4 \times 4\)</span> matrix? That’s why we use calculators or computer program to compute it.</p>
<div id="08426ca1" class="cell" data-execution_count="5">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">2</span>], [<span class="dv">6</span>, <span class="dv">2</span>, <span class="dv">4</span>], [<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">8</span>]])</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>inverse <span class="op">=</span> np.linalg.inv(A)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Inverse"</span>, inverse, sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Inverse
[[-0.25   0.375 -0.125]
 [ 1.25  -0.875  0.125]
 [-0.25   0.125  0.125]]</code></pre>
</div>
</div>
</section>
<section id="matrix-division---continuation" class="level3">
<h3 class="anchored" data-anchor-id="matrix-division---continuation">Matrix Division - continuation</h3>
<p>As we already know how to compute the inverse of a matrix, the division is easy now. If we have two matrices:</p>
<p><span class="math display">\[
A =
\begin{bmatrix}
    1 &amp; 2 &amp; 3 \\
    4 &amp; 5 &amp; 6 \\
    7 &amp; 8 &amp; 9
\end{bmatrix}
\]</span></p>
<p>and</p>
<p><span class="math display">\[
B =
\begin{bmatrix}
    4 &amp; 2 &amp; 2 \\
    6 &amp; 2 &amp; 4 \\
    2 &amp; 2 &amp; 8
\end{bmatrix}
\]</span></p>
<p>then <span class="math inline">\(A\)</span> divided by <span class="math inline">\(B\)</span> is</p>
<p><span class="math display">\[
A \cdot B^{-1}
\ =
\begin{bmatrix}
    1 &amp; 2 &amp; 3 \\
    4 &amp; 5 &amp; 6 \\
    7 &amp; 8 &amp; 9
\end{bmatrix}
\cdot
\begin{bmatrix}
    -0.25 &amp; 0.375 &amp; -0.125 \\
    1.25 &amp; 0.875 &amp; 0.125 \\
    -0.25 &amp; 0.125 &amp; 0.125
\end{bmatrix}
\ =
\begin{bmatrix}
    1.5 &amp; -1 &amp; 0.5 \\
    3.75 &amp; -2.125 &amp; 0.875 \\
    6 &amp; -3.25 &amp; 1.25
\end{bmatrix}
\ \equiv
A \div B
\]</span></p>
<div id="d7026236" class="cell" data-execution_count="6">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>], [<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>]])</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> np.array([[<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">2</span>], [<span class="dv">6</span>, <span class="dv">2</span>, <span class="dv">4</span>], [<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">8</span>]])</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># A divided by B is dot product between A and inverse of B</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>inv_B <span class="op">=</span> np.linalg.inv(B)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.dot(A, inv_B)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[ 1.5   -1.     0.5  ]
 [ 3.75  -2.125  0.875]
 [ 6.    -3.25   1.25 ]]</code></pre>
</div>
</div>
</section>
<section id="solving-system-of-equations-with-matrices" class="level3">
<h3 class="anchored" data-anchor-id="solving-system-of-equations-with-matrices">Solving System of Equations with Matrices</h3>
<p>In the previous blog, I talked about the system of linear equations and we solved this system graphically and algebraically. One of the great things about matrices, is that they can help us solve systems of equations. For example, consider the following system of equations:</p>
<p><span class="math display">\[
\begin{cases}
2x + 4y = 18 \\
6x + 2y = 34
\end{cases}
\]</span></p>
<p>We can write this in matrix form, like this:</p>
<p><span class="math display">\[
\begin{bmatrix}
    2 &amp; 4 \\
    6 &amp; 2
\end{bmatrix}
\cdot
\begin{bmatrix}
    x \\
    y
\end{bmatrix}
\ =
\begin{bmatrix}
    18 \\
    34
\end{bmatrix}
\]</span></p>
<p>If we calculate the dot product between the matrix and vector on the left side, we can see clearly that this represents the original equations.</p>
<p>Now let rename our matrices:</p>
<p><span class="math display">\[
A =
\begin{bmatrix}
    2 &amp; 4 \\
    6 &amp; 2
\end{bmatrix}
\quad
X =
\begin{bmatrix}
    x \\
    y
\end{bmatrix}
\quad
B =
\begin{bmatrix}
    18 \\
    34
\end{bmatrix}
\]</span></p>
<p>This can be represented as <span class="math inline">\(AX = B\)</span> and we know that to find <span class="math inline">\(X\)</span> we have to solve this: <span class="math inline">\(B \div A\)</span>. Since we cannot divide matrices in this way, we have to use the previous technique. Find the inverse of <span class="math inline">\(A\)</span> and multiply by <span class="math inline">\(B\)</span>.</p>
<p>The inverse of <span class="math inline">\(A\)</span>:</p>
<p><span class="math display">\[
A^{-1} =
\begin{bmatrix}
    -0.1 &amp; 0.2 \\
    0.3 &amp; -0.1
\end{bmatrix}
\]</span></p>
<p><span class="math display">\[
X =
\begin{bmatrix}
    -0.1 &amp; 0.2 \\
    0.3 &amp; -0.1
\end{bmatrix}
\cdot
\begin{bmatrix}
    18 \\
    34
\end{bmatrix}
\ =
\begin{bmatrix}
    5 \\
    2
\end{bmatrix}
\]</span></p>
<p>Now, instead of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> in the original equation put <span class="math inline">\(5\)</span> and <span class="math inline">\(2\)</span> and this will make equality true.</p>
<p><span class="math display">\[
10 + 8 = 18
\]</span> <span class="math display">\[
30 + 4 = 34
\]</span></p>
<div id="d96bf0dc" class="cell" data-execution_count="7">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">2</span>, <span class="dv">4</span>], [<span class="dv">6</span>, <span class="dv">2</span>]])</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> np.array([[<span class="dv">18</span>], [<span class="dv">34</span>]])</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>A_inverse <span class="op">=</span> np.linalg.inv(A)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The inverse of A is"</span>, A_inverse, sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.dot(A_inverse, B)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"X ="</span>, X, sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>The inverse of A is
[[-0.1  0.2]
 [ 0.3 -0.1]]
X =
[[5.]
 [2.]]</code></pre>
</div>
</div>
</section>
<section id="elementary-row-operations" class="level3">
<h3 class="anchored" data-anchor-id="elementary-row-operations">Elementary Row Operations</h3>
<p>Elementary Row Operations (ERO) play an important role in many matrix algebra applications, such as finding the inverse of a matrix and solving simultaneous linear equations. These topics are covered in advance part of the series. An ERO transforms a given matrix <span class="math inline">\(A\)</span> into a new matrix <span class="math inline">\(A^{'}\)</span> via one of the following operations:</p>
<ol type="1">
<li>Interchange two rows (or columns)</li>
<li>Multiply each element in a row (or column) by a non-zero number</li>
<li>Multiply a row (or column) by a non-zero number and add the result to another row (or column)</li>
</ol>
<p>To catch the idea behind this operations let do the example. We have a matrix <span class="math inline">\(A\)</span> such that</p>
<p><span class="math display">\[
A =
\begin{bmatrix}
    1 &amp; 2 &amp; 3 &amp; 4 \\
    1 &amp; 3 &amp; 5 &amp; 6 \\
    0 &amp; 1 &amp; 2 &amp; 3
\end{bmatrix}
\]</span></p>
<p>Type 1 ERO that interchange rows 1 and 3 of <span class="math inline">\(A\)</span> would yield</p>
<p><span class="math display">\[
A^{'} =
\begin{bmatrix}
    0 &amp; 1 &amp; 2 &amp; 3 \\
    1 &amp; 3 &amp; 5 &amp; 6 \\
    1 &amp; 2 &amp; 3 &amp; 4
\end{bmatrix}
\]</span></p>
<p>Type 2 ERO that multiplies row 2 of <span class="math inline">\(A\)</span> by 3 would yield</p>
<p><span class="math display">\[
A^{'} =
\begin{bmatrix}
    1 &amp; 2 &amp; 3 &amp; 4 \\
    3 &amp; 9 &amp; 15 &amp; 18 \\
    0 &amp; 1 &amp; 2 &amp; 3
\end{bmatrix}
\]</span></p>
<p>Type 3 ERO that multiplies row 2 of <span class="math inline">\(A\)</span> by 4 and replace row 3 of <span class="math inline">\(A\)</span> by <span class="math inline">\(4 \times (\text{row 2 of A}) + \text{row 3 of A}\)</span>,</p>
<p>would yield row 3 of <span class="math inline">\(A^{'}\)</span> to be</p>
<p><span class="math inline">\(4 \times [1 \ 3 \ 5 \ 6] + [0 \ 1 \ 2 \ 3] = [4 \ 13 \ 22 \ 27]\)</span></p>
<p>and</p>
<p><span class="math display">\[
A^{'} =
\begin{bmatrix}
    1 &amp; 2 &amp; 3 &amp; 4 \\
    1 &amp; 3 &amp; 5 &amp; 6 \\
    4 &amp; 13 &amp; 22 &amp; 27
\end{bmatrix}
\]</span></p>
<p>Except this, to perform an elementary row operation on the matrix <span class="math inline">\(A\)</span>, first we can perform the operation on the corresponding <strong>identity matrix</strong> to obtain an elementary matrix, then multiply <span class="math inline">\(A\)</span> on the left by this elementary matrix. More precisely this means that we take one ERO, whichever we want and perform this operation on corresponding identity matrix of <span class="math inline">\(A\)</span>. If <span class="math inline">\(A\)</span> has <span class="math inline">\(m \times n\)</span> dimension we have identity matrix <span class="math inline">\(I_{m \times n}\)</span>. After that, we multiply <span class="math inline">\(A\)</span> by this identity matrix. If we denote the elementary matrix by <span class="math inline">\(E\)</span> then, we multiply <span class="math inline">\(A\)</span> by <span class="math inline">\(E\)</span> in the following way:</p>
<p><span class="math display">\[
\begin{equation}E_{1} \cdot A \end{equation}
\]</span></p>
<p>where <span class="math inline">\(E_{1}\)</span> is ERO one performed on identity matrix.</p>
</section>
<section id="rank-of-a-matrix" class="level3">
<h3 class="anchored" data-anchor-id="rank-of-a-matrix">Rank of a Matrix</h3>
<p>The maximum number of linearly independent rows in a matrix <span class="math inline">\(A\)</span> is called the <strong>row rank</strong> of <span class="math inline">\(A\)</span> and the maximum number of linearly independent columns in <span class="math inline">\(A\)</span> is called the <strong>column rank</strong> of <span class="math inline">\(A\)</span>. If <span class="math inline">\(A\)</span> is <span class="math inline">\(n \times m\)</span> matrix, that is if matrix <span class="math inline">\(A\)</span> has <span class="math inline">\(m\)</span> rows and <span class="math inline">\(n\)</span> columns then the following inequality holds:</p>
<p><span class="math display">\[
\text{row rank of} \ A \leq m \\
\text{column rank of} \ A \leq n
\]</span></p>
<p>Furthermore, for any matrix <span class="math inline">\(A\)</span></p>
<p><span class="math display">\[
\text{row rank of} \ A = \text{column rank of} \ A
\]</span></p>
<p>From the above inequality it follows that</p>
<p><span class="math display">\[
Rank(A) \leq min(m, n)
\]</span></p>
<p>This means that if a matrix has, for example, 3 rows and 5 columns, its rank cannot be more than 3. The rank of a matrix would be zero if and only if the matrix had no elements. If a matrix had even one element, its minimum rank would be one. When all of the vectors in a matrix are linearly independent, the matrix is said to be <strong>full rank</strong>.</p>
<p>To calculate the rank of a matrix, we have to compute the determinant. It turns out that the rank of a matrix <span class="math inline">\(A\)</span>, denoted by <span class="math inline">\(Rank(A)\)</span> is the size of the largest non-zero <span class="math inline">\(m \times m\)</span> sub-matrix with non-zero determinant. To simplify further, if the determinant of <span class="math inline">\(4 \times 4\)</span> matrix <span class="math inline">\(A\)</span> is zero and any <span class="math inline">\(3 \times3\)</span> sub-matrix of original matrix <span class="math inline">\(A\)</span> has non-zero determinant then the rank of the original matrix <span class="math inline">\(A\)</span> is <span class="math inline">\(3\)</span>. So we can say that rank shows the <a href="https://en.wikipedia.org/wiki/Degenerate_bilinear_form">“non-degenerateness”</a> of the matrix <span class="math inline">\(A\)</span>.</p>
<p>Actually, there is no only one way to compute the rank. I will provide one more way in the advanced tutorial.</p>
<div id="0bf51d8f" class="cell" data-execution_count="8">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>], [<span class="dv">1</span>, <span class="op">-</span><span class="dv">3</span>, <span class="dv">5</span>]])</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>rank_A <span class="op">=</span> np.linalg.matrix_rank(A)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Rank(A) = "</span>, rank_A)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co"># matrix B has full rank</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> np.array([[<span class="dv">2</span>, <span class="dv">2</span>, <span class="op">-</span><span class="dv">1</span>], [<span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">2</span>], [<span class="dv">0</span>, <span class="dv">6</span>, <span class="op">-</span><span class="dv">3</span>]])</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>rank_B <span class="op">=</span> np.linalg.matrix_rank(B)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Rank(B) = "</span>, rank_B)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rank(A) =  2
Rank(B) =  3</code></pre>
</div>
</div>
</section>
<section id="power-of-a-matrix" class="level3">
<h3 class="anchored" data-anchor-id="power-of-a-matrix">Power of a Matrix</h3>
<p>We can rise a square matrix <span class="math inline">\(A\)</span> in any nonnegative power just like any number. This is defined as the product of <span class="math inline">\(A\)</span> by itself <span class="math inline">\(n\)</span> times. If matrix <span class="math inline">\(A\)</span> has inverse, then <span class="math inline">\(A^{-n} = (A^{-1})^{n}\)</span> or take inverse of <span class="math inline">\(A\)</span> and multiply by itself <span class="math inline">\(n\)</span> times.</p>
<p>For example, if</p>
<p><span class="math display">\[
A =
\begin{bmatrix}
    1 &amp; 2 \\
    3 &amp; 4
\end{bmatrix}
\]</span></p>
<p>then</p>
<p><span class="math display">\[
A^{2} =
A A
\ =
\begin{bmatrix}
    1 &amp; 2 \\
    3 &amp; 4
\end{bmatrix}
\cdot
\begin{bmatrix}
    1 &amp; 2 \\
    3 &amp; 4
\end{bmatrix}
\ =
\begin{bmatrix}
    7 &amp; 10 \\
    15 &amp; 22
\end{bmatrix}
\]</span></p>
<div id="5d66a68f" class="cell" data-execution_count="9">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>], [<span class="dv">3</span>, <span class="dv">4</span>]])</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>A_square <span class="op">=</span> np.linalg.matrix_power(A, <span class="dv">2</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(A_square)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[ 7 10]
 [15 22]]</code></pre>
</div>
</div>
</section>
<section id="norm-of-a-matrix" class="level3">
<h3 class="anchored" data-anchor-id="norm-of-a-matrix">Norm of a Matrix</h3>
<p>In the previous post I talked about vector norms but did not mentioned matrix norm. There are three types of matrix norms:</p>
<ul>
<li>Matrix norms induced by vector norms</li>
<li>Entrywise matrix norms</li>
<li>Schatten norms</li>
</ul>
<p>Here, I will introduce only the first two types of matrix norm and depict one example of each to give the general idea of matrix norms.</p>
<p>Induced norms usually are denoted by: <span class="math display">\[\|A\|_p\]</span></p>
<p>In the special cases of <span class="math inline">\(p = 1, 2, \infty\)</span>, the induced matrix norms can be computed by:</p>
<p><span class="math display">\[
\|A\|_1 = max_{1\leq j \leq m} \sum_{i = 1}^{m}|a_{ij}|
\]</span></p>
<p>Which is the maximum absolute column sum of the matrix <span class="math inline">\(A\)</span></p>
<p><span class="math display">\[
\|A\|_2 = \|A\|_F = \sigma_{max}(A)
\]</span></p>
<p>Where <span class="math inline">\(\|A\|_F\)</span> is Frobenius Norm, which will be discussed below and <span class="math inline">\(\sigma_{max}(A)\)</span> is the spectral norm. The later will be discussed in the next post.</p>
<p><span class="math display">\[
\|A\|_{\infty} = max_{1\leq i \leq m} \sum_{j = 1}^{n}|a_{ij}|
\]</span></p>
<p>which is the maximum absolute row sum of the matrix <span class="math inline">\(A\)</span>.</p>
<p>To clarify this farther, let consider the following example:</p>
<p><span class="math display">\[
A =
\begin{bmatrix}
    1 &amp; 2 &amp; 3 \\
    4 &amp; 5 &amp; 6 \\
    7 &amp; 8 &amp; 9
\end{bmatrix}
\]</span></p>
<p><span class="math display">\[
\|A\|_1 = max(|1| + |4| + |7|; |2| + |5| + |8|; |3| + |6| + |9|) = max(12; 15; 18) = 18
\]</span> <span class="math display">\[
\quad
\]</span> <span class="math display">\[
\|A\|_{\infty} = max(|1| + |2| + |3|; |4| + |5| + |6|; |7| + |8| + |9|) = max(6; 15; 24) = 24
\]</span></p>
<p>Imagine, we have a vector whose elements are matrices instead of scalars. Then norm defined here is entrywise matrix norm. The general formula for entrywise matrix norm is:</p>
<p><span class="math display">\[
\|A\|_{p,q} = \left(\sum_{j=1}^{n}\left(\sum_{i=1}^{m}|a_{ij}^{p}\right)^\frac{q}{p}\right)^\frac{1}{q}
\]</span></p>
<p>where <span class="math inline">\(p,q \geq 1\)</span></p>
<p>When <span class="math inline">\(p=q=2\)</span> we have Frobenius Norm or Frobenius Inner Product:</p>
<p><span class="math display">\[
\|A\|_{F} = \sqrt{\sum_{i=1}^m \sum_{j=1}^{n}|a_{ij}|^2}
\]</span></p>
<p>and when <span class="math inline">\(p=q=\infty\)</span>, we have Max Norm:</p>
<p><span class="math display">\[
\|A\|_{max} = max_{ij}|a_{ij}|
\]</span></p>
<p>If we have matrix <span class="math inline">\(A\)</span> such that:</p>
<p><span class="math display">\[
A =
\begin{bmatrix}
    1 &amp; 2 &amp; 3 \\
    4 &amp; 5 &amp; 6 \\
    7 &amp; 8 &amp; 9
\end{bmatrix}
\]</span></p>
<p>Then Frobenius Norm is:</p>
<p><span class="math display">\[
\|A\|_{F} = \sqrt{(|1|^2 + |2|^2 + |3|^2 + |4|^2 + |5|^2 + |6|^2 + |7|^2 + |8|^2 + |9|^2)} =
\]</span></p>
<p><span class="math display">\[
\sqrt{1 + 4 + 9 + 16 + 25 + 36 + 49 + 64 + 81} = \sqrt{285} \approx 16.89
\]</span></p>
<p>For two matrices <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> we have Frobenius Inner Product:</p>
<p><span class="math display">\[
\langle A,B \rangle_{F} = \sum_{i,j}\overline{A_{i,j}}B_{i,j} = tr \left(\overline{A^T}B \right)
\]</span></p>
<p>Where overline denotes the complex conjugate of a matrix.</p>
<p>If</p>
<p><span class="math display">\[
A =
\begin{bmatrix}
    2 &amp; 0 \\
    1 &amp; 1 \\
\end{bmatrix}
\]</span></p>
<p>and</p>
<p><span class="math display">\[
B =
\begin{bmatrix}
    8 &amp; -3 \\
    4 &amp; 1 \\
\end{bmatrix}
\]</span></p>
<p>then</p>
<p><span class="math display">\[
\langle A,B \rangle_{F} = 2 \cdot 8 + 0 \cdot (-3) + 1 \cdot 4 + 1 \cdot 1 = 21
\]</span></p>
<div id="24a85f6a" class="cell" data-execution_count="10">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>], [<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>]])</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>frobenius_norm <span class="op">=</span> np.linalg.norm(A, <span class="bu">ord</span><span class="op">=</span><span class="st">"fro"</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>column_max_norm <span class="op">=</span> np.linalg.norm(A, <span class="bu">ord</span><span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>row_max_norm <span class="op">=</span> np.linalg.norm(A, <span class="bu">ord</span><span class="op">=</span>np.inf)  <span class="co"># same as infinity norm</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Frobenius Inner Product</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">2</span>, <span class="dv">0</span>], [<span class="dv">1</span>, <span class="dv">1</span>]])</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> np.array([[<span class="dv">8</span>, <span class="op">-</span><span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">1</span>]])</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="co"># numpy.vdot function flattens high dimensional arrays and takes dot product</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>frobenius_inner_product <span class="op">=</span> np.vdot(A, B)</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Frobenius Norm is: "</span>, frobenius_norm)</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Column Max Norm is: "</span>, column_max_norm)</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Row Max Norm is: "</span>, row_max_norm)</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Frobenius Inner Product is: "</span>, frobenius_inner_product)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Frobenius Norm is:  16.881943016134134
Column Max Norm is:  18.0
Row Max Norm is:  24.0
Frobenius Inner Product is:  21</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>To sum up, both parts of intermediate linear algebra, we’ve reviewed a lot of materials. Some of them seemed easy, while some of them at the first glance seemed complex, but I do hope a little more practice and reading this tutorial 2 times will help you to master all of these intuitions further.</p>
<section id="references" class="level4">
<h4 class="anchored" data-anchor-id="references">References</h4>
<ul>
<li><a href="http://math.mit.edu/~gs/linearalgebra/">Introduction To Linear Algebra</a></li>
<li><a href="https://en.wikipedia.org/wiki/List_of_linear_algebra_topics">Linear Algebra Topics</a></li>
<li><a href="https://www.khanacademy.org/math/linear-algebra">Khan Academy - Linear Algebra</a></li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/okrodata\.dev");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="light">
<script>
  function loadGiscus() {
    // Function to get the theme based on body class
    const getTheme = () => {
      let baseTheme = document.getElementById('giscus-base-theme').value;
      let altTheme = document.getElementById('giscus-alt-theme').value;
      return document.body.classList.contains('quarto-dark') ? altTheme : baseTheme;
    };
    const script = document.createElement("script");
    script.src = "https://giscus.app/client.js";
    script.async = true;
    script.dataset.repo = "Okroshiashvili/okrodata";
    script.dataset.repoId = "R_kgDOPtLDxQ";
    script.dataset.category = "General";
    script.dataset.categoryId = "";
    script.dataset.mapping = "title";
    script.dataset.reactionsEnabled = "1";
    script.dataset.emitMetadata = "0";
    script.dataset.inputPosition = "bottom";
    script.dataset.theme = getTheme();
    script.dataset.lang = "en";
    script.crossOrigin = "anonymous";
    // Append the script to the desired div instead of at the end of the body
    document.getElementById("quarto-content").appendChild(script);
  }
  loadGiscus();
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Copyright 2025, Nodar Okroshiashvili</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>